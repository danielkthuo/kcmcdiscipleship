<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FOUNDATION TO NEW BELIEVERS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Add Firebase imports -->
    <script type="module" src="../auth-check.js"></script>
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#2c3e50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="KCM Church">
    <meta name="description" content="Discipleship Tool for Kingdom Covenant Ministries Church">
    <meta name="keywords" content="church, discipleship, christian, ministry">
    <meta name="author" content="Kingdom Covenant Ministries Church">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="icons/icon-152x152.png">
    <link rel="apple-touch-startup-image" href="icons/icon-512x512.png">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Viewport for mobile optimization -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <!-- Preload important resources -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com/ajax.googleapis.com">
    
    <style>
        /* ===== CSS VARIABLES ===== */
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --prayer-color: #9c27b0;
            --fellowship-color: #e67e22;
            --gospel-color: #27ae60;
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --radius: 8px;
        }

        /* ===== RESET & BASE STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            font-family: var(--font-main);
            background: #f9f9f9;
            color: #333;
            scroll-behavior: smooth;
            line-height: 1.6;
        }

        /* ===== HEADER ===== */
        header {
            width: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1.5rem 1rem;
            text-align: center;
            position: relative;
            box-shadow: var(--shadow);
        }

        header h1 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        header .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }

        .progress-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: var(--accent);
            transition: width 0.5s ease;
        }

        /* ===== MAIN CONTENT ===== */
        .container {
            width: 100%;
            padding: 0 1rem 100px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* ===== BUTTONS ===== */
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--secondary);
            color: white;
            padding: 14px 20px;
            border-radius: var(--radius);
            border: none;
            font-weight: 600;
            text-decoration: none;
            font-size: 1rem;
            width: 100%;
            transition: all 0.3s;
            cursor: pointer;
            gap: 8px;
        }

        .btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--secondary);
            color: var(--secondary);
        }

        .btn-outline:hover {
            background: var(--secondary);
            color: white;
        }

        .btn-prayer {
            background: var(--prayer-color);
        }

        .btn-fellowship {
            background: var(--fellowship-color);
        }

        .btn-gospel {
            background: var(--gospel-color);
        }

        /* ===== NAVIGATION ===== */
        .lesson-nav {
            display: flex;
            gap: 10px;
            margin: 1.5rem 0;
        }

        /* ===== COLLAPSIBLE SECTIONS ===== */
        .collapsible-section {
            margin-bottom: 1rem;
            width: 100%;
        }

        .collapsible-header {
            width: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            text-align: left;
            padding: 1.2rem 1.5rem;
            font-weight: 600;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            font-size: 1.1rem;
        }

        .collapsible-header:hover {
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .collapsible-header i {
            transition: transform 0.3s ease;
        }

        .collapsible-header.active i {
            transform: rotate(180deg);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            background: white;
            border-radius: 0 0 var(--radius) var(--radius);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .collapsible-content.active {
            max-height: 500px;
            overflow-y: auto;
        }

        .content-inner {
            padding: 1.5rem;
        }

        /* ===== ENHANCED CONTENT STYLES ===== */
        .content-section {
            margin-bottom: 2rem;
        }

        .content-section h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--secondary);
            font-size: 1.3rem;
        }

        .topic {
            background-color: white;
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            position: relative;
            width: 100%;
        }

        .topic h2 {
            color: var(--primary);
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 0.5rem;
            font-size: 1.4rem;
        }

        .scripture {
            background: linear-gradient(to right, #f8f9fa, #e9ecef);
            border-left: 6px solid var(--secondary);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 var(--radius) var(--radius) 0;
            font-style: italic;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .scripture:before {
            content: "üìñ";
            position: absolute;
            left: -35px;
            top: 15px;
            font-size: 1.2rem;
            background: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .key-point {
            background: linear-gradient(to right, #e8f4fc, #d4edfc);
            border-left: 6px solid var(--success);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 var(--radius) var(--radius) 0;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .key-point:before {
            content: "üí°";
            position: absolute;
            left: -35px;
            top: 15px;
            font-size: 1.2rem;
            background: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .reflection {
            background: linear-gradient(to right, #f0f7ff, #e1f0ff);
            border-left: 6px solid #9b59b6;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 var(--radius) var(--radius) 0;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .reflection:before {
            content: "‚úçÔ∏è";
            position: absolute;
            left: -35px;
            top: 15px;
            font-size: 1.2rem;
            background: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .reflection textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: var(--radius);
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s;
        }

        .reflection textarea:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .activity {
            background: linear-gradient(to right, #fff8e1, #ffecb3);
            border-left: 6px solid #ffc107;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 var(--radius) var(--radius) 0;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .activity:before {
            content: "üéØ";
            position: absolute;
            left: -35px;
            top: 15px;
            font-size: 1.2rem;
            background: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .prayer-method {
            background: linear-gradient(to right, #f3e5f5, #e1bee7);
            border-left: 6px solid var(--prayer-color);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 var(--radius) var(--radius) 0;
            position: relative;
        }
        .prayer-method:before {
            content: "üôè";
            position: absolute;
            left: -35px;
            top: 15px;
            font-size: 1.2rem;
            background: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .gospel-section {
            background: linear-gradient(to right, #e8f5e9, #c8e6c9);
            border-left: 6px solid var(--gospel-color);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 var(--radius) var(--radius) 0;
            position: relative;
        }
        .gospel-section:before {
            content: "‚úùÔ∏è";
            position: absolute;
            left: -35px;
            top: 15px;
            font-size: 1.2rem;
            background: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* ===== ILLUSTRATIONS ===== */
        .illustration {
            width: 100%;
            margin: 1.5rem 0;
            background: white;
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            text-align: center;
        }

        /* Prayer Hand Styles */
        .prayer-hand {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }

        .hand-fingers {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 20px;
            gap: 10px;
        }

        .finger {
            width: 70px;
            height: 100px;
            background-color: #f5d7b4;
            border-radius: 35px 35px 0 0;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .finger-label {
            position: absolute;
            bottom: -30px;
            font-weight: bold;
            font-size: 0.8rem;
            text-align: center;
            width: 100px;
            left: 50%;
            transform: translateX(-50%);
        }

        .finger-content {
            margin-top: 40px;
            text-align: center;
        }

        .finger-item {
            margin-bottom: 15px;
        }

        /* Bridge Illustration Styles */
        .bridge-container {
            background-color: #f8f9fa;
            border-radius: var(--radius);
            padding: 1.5rem;
            margin: 1.5rem 0;
            position: relative;
            width: 100%;
        }

        .bridge-illustration {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }

        .bridge-sides {
            display: flex;
            flex-direction: column;
            width: 100%;
            margin-bottom: 20px;
            gap: 15px;
        }

        .bridge-side {
            width: 100%;
            text-align: center;
            padding: 15px;
            border-radius: var(--radius);
        }

        .god-side {
            background-color: #e1f5fe;
            border: 2px solid #4fc3f7;
        }

        .man-side {
            background-color: #ffebee;
            border: 2px solid #e57373;
        }

        .bridge-gap {
            width: 100%;
            height: 50px;
            background: linear-gradient(to bottom, #ff8a65, #d84315);
            border-radius: 5px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .bridge-cross {
            width: 100%;
            height: 70px;
            position: relative;
            margin: 20px 0;
        }

        .cross-vertical {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 8px;
            height: 100%;
            background-color: #8d6e63;
            border-radius: 5px;
        }

        .cross-horizontal {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            height: 8px;
            background-color: #8d6e63;
            border-radius: 5px;
        }

        .cross-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            color: #5d4037;
        }

        .bridge-steps {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .bridge-step {
            background: white;
            border-radius: var(--radius);
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            width: 100%;
        }

        .bridge-step h5 {
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .bridge-step h5 span {
            display: inline-block;
            width: 24px;
            height: 24px;
            background-color: var(--secondary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 24px;
            margin-right: 8px;
        }

        /* Fellowship Map Styles */
        .fellowship-map-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .fellowship-map-circle {
            width: 280px;
            height: 280px;
            border: 2px solid var(--fellowship-color);
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .fellowship-center {
            width: 70px;
            height: 70px;
            background-color: var(--fellowship-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            z-index: 10;
        }

        .fellowship-category {
            position: absolute;
            width: 100px;
            text-align: center;
        }

        .fellowship-mentors {
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
        }

        .fellowship-peers {
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
        }

        .fellowship-mentees {
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
        }

        .fellowship-others {
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
        }

        /* Wheel Illustration Styles */
        .wheel-container {
            text-align: center;
            margin: 20px 0;
        }

        .wheel-illustration {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 0 auto;
        }

        .wheel-rim {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 8px solid #3498db;
            border-radius: 50%;
        }

        .wheel-hub {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 70px;
            background-color: #e74c3c;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            z-index: 10;
        }

        .spoke-label, .rim-label {
            background: white;
            padding: 5px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* Comparison Table */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            display: block;
            overflow-x: auto;
            white-space: nowrap;
        }

        .comparison-table th, .comparison-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .comparison-table th {
            background-color: var(--primary);
            color: white;
        }

        .comparison-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        /* ===== BOTTOM NAVIGATION ===== */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            display: flex;
            justify-content: space-around;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            padding: 10px 0;
        }

        .nav-item {
            flex: 1;
            text-align: center;
            color: #666;
            text-decoration: none;
            font-size: 0.8rem;
            padding: 5px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .nav-item.active {
            color: var(--secondary);
        }

        .nav-icon {
            font-size: 1.2rem;
        }

        /* ===== FOOTER ===== */
        footer {
            width: 100%;
            background: var(--dark);
            color: white;
            text-align: center;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        /* ===== PROGRESS INDICATOR ===== */
        .sync-status {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .sync-status.syncing {
            color: var(--warning);
        }

        .sync-status.synced {
            color: var(--success);
        }

        .sync-status.local {
            color: var(--secondary);
        }

        .sync-status.offline {
            color: #666;
        }

        /* ===== COMPLETION INDICATOR ===== */
        .completion-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 1rem;
            padding: 10px;
            background: #f8f9fa;
            border-radius: var(--radius);
        }

        .completion-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #ccc;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .completion-checkbox.checked {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        /* Topic Completion */
        .topic-completion {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 2px solid #ddd;
            background-color: white;
            cursor: pointer;
            min-height: 44px;
            min-width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .topic-completed {
            background-color: var(--success);
            border-color: var(--success);
        }

        .topic-completed::after {
            content: "‚úì";
            color: white;
            font-weight: bold;
        }

        /* ===== NEW: BACK TO TOP BUTTON ===== */
        .back-to-top {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--secondary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 998;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
        }
        .back-to-top.visible {
            opacity: 1;
        }
        .back-to-top:hover {
            transform: translateY(-3px);
            background: var(--primary);
        }

        /* ===== NEW: DARK MODE TOGGLE ===== */
        .dark-mode-toggle {
            position: fixed;
            top: 10px;
            left: 10px;
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 998;
        }

        /* ===== NEW: QUICK NAVIGATION ===== */
        .quick-nav {
            position: fixed;
            top: 80px;
            left: 20px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 10px;
            z-index: 997;
            display: none;
        }
        .quick-nav.active {
            display: block;
        }
        .quick-nav-item {
            display: block;
            padding: 8px 12px;
            color: var(--primary);
            text-decoration: none;
            border-radius: 4px;
            margin-bottom: 5px;
            transition: background 0.3s;
        }
        .quick-nav-item:hover {
            background: #f0f7ff;
        }
        .quick-nav-toggle {
            position: fixed;
            top: 80px;
            left: 20px;
            width: 40px;
            height: 40px;
            background: var(--secondary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 998;
        }

        /* ===== NEW: NOTE-TAKING FUNCTIONALITY ===== */
        .note-section {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px dashed #ddd;
        }
        .note-input {
            width: 100%;
            min-height: 80px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: var(--radius);
            font-family: inherit;
            resize: vertical;
            margin-bottom: 10px;
        }
        .note-save {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: var(--radius);
            cursor: pointer;
            font-size: 0.9rem;
        }
        .saved-notes {
            margin-top: 1rem;
        }
        .saved-note {
            background: #f9f9f9;
            padding: 10px;
            border-radius: var(--radius);
            margin-bottom: 10px;
            border-left: 3px solid var(--secondary);
        }
        .note-date {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 5px;
        }

        /* ===== NEW: DARK MODE STYLES ===== */
        body.dark-mode {
            background: #1a1a1a;
            color: #e0e0e0;
        }
        body.dark-mode .collapsible-content {
            background: #2d2d2d;
        }
        body.dark-mode .content-inner {
            background: #2d2d2d;
        }
        body.dark-mode .topic {
            background: #2d2d2d;
        }
        body.dark-mode .scripture {
            background: linear-gradient(to right, #2d2d2d, #3d3d3d);
        }
        body.dark-mode .key-point {
            background: linear-gradient(to right, #2d3d4d, #3d4d5d);
        }
        body.dark-mode .reflection {
            background: linear-gradient(to right, #2d2d4d, #3d3d5d);
        }
        body.dark-mode .reflection textarea {
            background: #3d3d3d;
            color: #e0e0e0;
            border-color: #555;
        }
        body.dark-mode .activity {
            background: linear-gradient(to right, #3d3d2d, #4d4d3d);
        }
        body.dark-mode .prayer-method {
            background: linear-gradient(to right, #3d2d3d, #4d3d4d);
        }
        body.dark-mode .gospel-section {
            background: linear-gradient(to right, #2d3d2d, #3d4d3d);
        }
        body.dark-mode .illustration {
            background: #2d2d2d;
        }
        body.dark-mode .completion-indicator {
            background: #3d3d3d;
        }
        body.dark-mode .bottom-nav {
            background: #2d2d2d;
        }
        body.dark-mode .nav-item {
            color: #b0b0b0;
        }
        body.dark-mode .nav-item.active {
            color: var(--secondary);
            background: #3d4d5d;
        }
        body.dark-mode .saved-note {
            background: #3d3d3d;
        }
        body.dark-mode .note-input {
            background: #3d3d3d;
            color: #e0e0e0;
            border-color: #555;
        }
        body.dark-mode .quick-nav {
            background: #2d2d2d;
        }
        body.dark-mode .quick-nav-item {
            color: #e0e0e0;
        }
        body.dark-mode .quick-nav-item:hover {
            background: #3d4d5d;
        }
        body.dark-mode .comparison-table th {
            background-color: #3d3d3d;
        }
        body.dark-mode .comparison-table tr:nth-child(even) {
            background-color: #2d2d2d;
        }
        body.dark-mode .comparison-table td {
            border-color: #555;
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 768px) {
            header h1 {
                font-size: 1.3rem;
            }
            
            header .subtitle {
                font-size: 0.9rem;
            }
            
            .collapsible-header {
                padding: 1rem;
                font-size: 1rem;
            }
            
            .content-inner {
                padding: 1rem;
            }
            
            .hands-container {
                flex-direction: column;
                gap: 1rem;
            }
            
            .work-piece {
                margin: 1rem 0;
                transform: rotate(90deg);
            }
            
            .lesson-nav {
                flex-direction: column;
            }
            
            .scripture:before, .key-point:before, .reflection:before, .activity:before, .prayer-method:before, .gospel-section:before {
                left: -25px;
                width: 20px;
                height: 20px;
                font-size: 0.9rem;
            }
            
            .finger {
                width: 60px;
                height: 90px;
            }
            
            .fellowship-map-circle {
                width: 250px;
                height: 250px;
            }
            
            .wheel-illustration {
                width: 250px;
                height: 250px;
            }
            
            .wheel-hub {
                width: 60px;
                height: 60px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 0.5rem 100px;
            }
            
            .collapsible-header {
                padding: 0.8rem;
                font-size: 0.95rem;
            }
            
            .content-inner {
                padding: 0.8rem;
            }
            
            .reflection textarea {
                min-height: 100px;
            }
        }

        /* ===== SCROLLBAR STYLING ===== */
        .collapsible-content::-webkit-scrollbar {
            width: 8px;
        }

        .collapsible-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .collapsible-content::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 4px;
        }

        .collapsible-content::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <!-- NEW: Dark mode toggle -->
    <div class="dark-mode-toggle" id="darkModeToggle">
        <i class="fas fa-moon"></i>
    </div>
    
    <!-- NEW: Quick navigation toggle -->
    <div class="quick-nav-toggle" id="quickNavToggle">
        <i class="fas fa-bars"></i>
    </div>
    
    <!-- NEW: Quick navigation menu -->
    <div class="quick-nav" id="quickNav">
        <a href="#topic1" class="quick-nav-item">Topic 1: Prayer</a>
        <a href="#topic2" class="quick-nav-item">Topic 2: Fellowship</a>
    </div>
    
    <!-- Header Section -->
    <header>
        <h1>MODULE 2: FOUNDATION TO NEW BELIEVERS</h1>
        <p class="subtitle">Discipleship Growth Topics - Clear Understanding of the Gospel, Prayer, Fellowship, and the Wheel Illustration (Spiritual Growth Wheel)</p>
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <!-- NEW: Enhanced Progress Bar -->
        <div class="enhanced-progress-container">
            <div class="enhanced-progress-bar" id="enhancedProgressBar">0%</div>
        </div>
        <div class="progress-info">
            <span>Progress: <span id="progressText">0%</span></span>
            <span>Last saved: <span id="lastSaved">Not saved yet</span></span>
        </div>
        
        <!-- Navigation Buttons -->
        <div class="lesson-nav">
            <a href="module-lesson1.html" class="btn btn-outline">
                <i class="fas fa-arrow-left"></i> Previous Lesson
            </a>
            <a href="module-lesson3.html" class="btn">
                Next Lesson <i class="fas fa-arrow-right"></i>
            </a>
        </div>
        
        <!-- Key Point -->
        <div class="key-point">
            <p>
                These key discipleship topics form the foundation of a believer's journey ‚Äî helping every Christian build a
                strong relationship with God, connect deeply with others, and live out their faith daily.
            </p>
        </div>
        
        <!-- Topic 1: Prayer -->
        <div class="topic" id="topic1">
            <div class="topic-completion" id="topic1Completion"></div>
            <h2>Topic 1: Prayer</h2>
            
            <!-- ACTS Prayer Method Collapsible -->
            <div class="collapsible-section">
                <button class="collapsible-header">
                    ACTS Prayer Method
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div class="topic-section">
                            <h3 class="text-primary fw-bold">ACTS Prayer Method</h3>
                            <p>
                                <strong>ACTS</strong> is a simple pattern to follow when praying ‚Äî helping us cover all parts of our relationship with God.
                            </p>
                            <p>
                                Prayer is much more than asking for things ‚Äî it's a heart-to-heart conversation with God. It includes:
                            </p>
                            <ul>
                                <li>Praising God</li>
                                <li>Confessing our sins</li>
                                <li>Giving thanks</li>
                                <li>Asking for help</li>
                            </ul>

                            <p>
                                God wants to hear from us ‚Äî not because He needs information, but because He desires relationship.
                            </p>

                            <div class="scripture mb-3">
                                <p><strong>Philippians 4:6</strong> ‚Äî "Do not be anxious about anything, but in every situation, by prayer and petition, with thanksgiving, present your requests to God."</p>
                            </div>

                            <div class="facilitator">
                                <h5>üë• Facilitator Notes:</h5>
                                <ul>
                                    <li>Explain that prayer is not just about asking ‚Äî it also includes praise, confession, and thanksgiving.</li>
                                    <li>Demonstrate the ACTS prayer pattern with a short example prayer.</li>
                                    <li>Emphasize how ACTS keeps our prayers balanced and our relationship with God strong.</li>
                                    <li>Encourage learners to write an ACTS prayer during the week to practice it.</li>
                                </ul>
                            </div>

                            <div class="acts-breakdown mt-3">
                                <h5>üìò ACTS Breakdown:</h5>
                                <ul>
                                    <li><strong>Adoration:</strong> Praise God for who He is ‚Äî <em>Psalm 95:6</em><br>
                                        "Come, let us bow down in worship, let us kneel before the LORD our Maker."</li>
                                    <li><strong>Confession:</strong> Admit sin and ask forgiveness ‚Äî <em>1 John 1:9</em><br>
                                        "If we confess our sins, He is faithful and just to forgive..."</li>
                                    <li><strong>Thanksgiving:</strong> Express gratitude for all things ‚Äî <em>1 Thessalonians 5:18</em></li>
                                    <li><strong>Supplication:</strong> Ask God for your needs ‚Äî <em>John 16:24</em></li>
                                </ul>
                            </div>

                            <div class="examples mt-3">
                                <h5>üïäÔ∏è Example Prayers:</h5>
                                <ol>
                                    <li>Lord, You are wonderful and kind. I confess my mistakes and ask for forgiveness. Thank You for Your love and blessings. Guide me today and help others in need. Amen.</li>
                                    <li>Dear God, You are amazing! I'm sorry for the wrongs I've done. Thank You for my family and all You provide. Help me be kind and caring. Amen.</li>
                                </ol>
                            </div>

                            <div class="reflection mt-3">
                                <h5>üí≠ Learner Reflection:</h5>
                                <ul>
                                    <li>Which part of the ACTS method do I practice most easily?</li>
                                    <li>What steps can I take to grow in the parts I don't focus on?</li>
                                </ul>
                                <textarea placeholder="Share your reflection..." data-save-key="acts_reflection"></textarea>
                                <div class="auto-save-label">
                                    <span class="save-indicator" id="indicator_acts_reflection"></span>
                                    Auto-saved
                                </div>
                            </div>

                            <div class="activity mt-3">
                                <h5>‚úçÔ∏è Additional Learner Activities:</h5>
                                <ul>
                                    <li>Spend 2 minutes each day dedicated to <strong>Adoration</strong>.</li>
                                    <li>Each night, write one sentence of gratitude in a journal.</li>
                                    <li>Challenge: Write a full ACTS prayer by week's end.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Prayer Hand Illustration Collapsible -->
            <div class="collapsible-section">
                <button class="collapsible-header">
                    ‚úã Prayer Hand Illustration
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div class="scripture">
                            <p><strong>üìñ Colossians 4:2</strong> ‚Äî "Devote yourselves to prayer, being watchful and thankful."</p>
                        </div>

                        <h5>üë• Facilitator Notes:</h5>
                        <ul>
                            <li>Show your hand and explain each finger's meaning.</li>
                            <li>Lead a time of prayer through each category.</li>
                            <li>Have learners draw or decorate their own "Prayer Hand."</li>
                        </ul>

                        <div class="hand-guide">
                            <p><strong>1Ô∏è‚É£ Thumb ‚Äî Praise:</strong> Psalm 145:3</p>
                            <p>Thank God for His greatness, holiness, love, and power.</p>

                            <p><strong>2Ô∏è‚É£ Index ‚Äî Confession:</strong> 1 John 1:9</p>
                            <p>Admit sins and ask forgiveness.</p>

                            <p><strong>3Ô∏è‚É£ Middle ‚Äî Intercession:</strong> 1 Timothy 2:1</p>
                            <p>Pray for others ‚Äî family, friends, leaders, and the sick.</p>

                            <p><strong>4Ô∏è‚É£ Ring ‚Äî Petition:</strong> Matthew 7:7</p>
                            <p>Bring your personal needs ‚Äî strength, peace, and wisdom.</p>

                            <p><strong>5Ô∏è‚É£ Pinky ‚Äî Thanksgiving:</strong> 1 Thessalonians 5:18</p>
                            <p>Thank God for all blessings, big and small.</p>

                            <p>üé• <a href="https://youtu.be/2m10fUWF-B8" target="_blank">Watch Video Clip</a></p>
                        </div>

                        <div class="reflection">
                            <h5>üí≠ Learner Reflection:</h5>
                            <ul>
                                <li>How can the Prayer Hand help you connect more deeply with God?</li>
                                <li>Which finger will you start applying more in prayer this week?</li>
                            </ul>
                            <textarea placeholder="Share your reflection..." data-save-key="prayer_hand_reflection"></textarea>
                            <div class="auto-save-label">
                                <span class="save-indicator" id="indicator_prayer_hand_reflection"></span>
                                Auto-saved
                            </div>
                        </div>

                        <div class="activity">
                            <h5>üé≠ Activity: Prayer Hand Skit</h5>
                            <p>In groups, act out the five types of prayer (praise, confession, intercession, petition, thanksgiving). Each group demonstrates one type in a 2-minute skit.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simple Prayer List Collapsible -->
            <div class="collapsible-section">
                <button class="collapsible-header">
                    üóíÔ∏è Simple Prayer List
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div class="scripture">
                            <p><strong>üìñ Colossians 4:2</strong> ‚Äî "Devote yourselves to prayer, being watchful and thankful."</p>
                        </div>

                        <h5>üë• Facilitator Notes:</h5>
                        <ul>
                            <li>Encourage learners to maintain a prayer list (digital or written).</li>
                            <li>Review answered prayers often to build gratitude.</li>
                            <li>Model a simple two-column "Requests" and "Answers" journal.</li>
                        </ul>

                        <div class="reflection">
                            <h5>üí≠ Reflection:</h5>
                            <ul>
                                <li>What people or needs will I commit to pray for consistently?</li>
                                <li>How can recording answered prayers strengthen my faith?</li>
                            </ul>
                            <textarea placeholder="Share your prayer list plans..." data-save-key="prayer_list_plans"></textarea>
                            <div class="auto-save-label">
                                <span class="save-indicator" id="indicator_prayer_list_plans"></span>
                                Auto-saved
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Praying in the Name of Jesus Collapsible -->
            <div class="collapsible-section">
                <button class="collapsible-header">
                    ‚úùÔ∏è Praying in the Name of Jesus
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div class="scripture">
                            <p><strong>üìñ John 14:13‚Äì14</strong> ‚Äî "And I will do whatever you ask in My name... You may ask Me for anything in My name, and I will do it."</p>
                        </div>

                        <h5>üë• Facilitator Notes:</h5>
                        <ul>
                            <li>Praying in Jesus' name means praying with His authority and access to the Father.</li>
                            <li>It's not a "magic phrase," but a posture of humility, trust, and alignment with God's will.</li>
                            <li>Use a role-play to explain how "authority" works in prayer.</li>
                        </ul>

                        <h5>üìå Key Points:</h5>
                        <ul>
                            <li>Jesus is the way to the Father (<em>John 14:6</em>).</li>
                            <li>When we pray in Jesus' name, we trust His character, submit to His will, and reflect His mission.</li>
                        </ul>

                        <p><strong>Example Prayer:</strong> "Lord, help me forgive my friend just like You forgave me. In Jesus' name, Amen."</p>

                        <div class="reflection">
                            <h5>üí≠ Reflection:</h5>
                            <p>What does praying "in Jesus' name" mean to you personally?</p>
                            <textarea placeholder="Share your understanding..." data-save-key="jesus_name_understanding"></textarea>
                            <div class="auto-save-label">
                                <span class="save-indicator" id="indicator_jesus_name_understanding"></span>
                                Auto-saved
                            </div>
                        </div>

                        <div class="activity">
                            <h5>üé® Learner Activities:</h5>
                            <ul>
                                <li>"Who is Jesus?" Poster ‚Äî draw or list words that describe Him (Savior, King, Friend, Shepherd, etc.).</li>
                                <li>Role Play: "Right Authority" ‚Äî one child gains access "in the name" of someone else; discuss what it means spiritually.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- How to Spend a Day in Prayer Collapsible -->
            <div class="collapsible-section">
                <button class="collapsible-header">
                    üï∞Ô∏è How to Spend a Day in Prayer
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div class="scripture">
                            <p><strong>üìñ Luke 5:16</strong> ‚Äî "But Jesus often withdrew to lonely places and prayed."</p>
                        </div>

                        <h5>üë• Facilitator Notes:</h5>
                        <ul>
                            <li>Encourage learners to start small ‚Äî perhaps a few focused hours of prayer.</li>
                            <li>Include time for praise, Bible reading, journaling, and intercession.</li>
                            <li>Remind learners that listening and silence are part of prayer too.</li>
                        </ul>

                        <h5>üïäÔ∏è Outline for a Prayer Day:</h5>
                        <ul>
                            <li><strong>Morning:</strong> Praise & Thanksgiving (<em>Psalm 100:4</em>)</li>
                            <li><strong>Mid-Morning:</strong> Bible Reading & Listening (<em>Psalm 119:18</em>)</li>
                            <li><strong>Afternoon:</strong> Intercession (<em>1 Timothy 2:1‚Äì2</em>)</li>
                            <li><strong>Evening:</strong> Confession, Gratitude & Reflection (<em>Psalm 139:23‚Äì24</em>)</li>
                        </ul>

                        <div class="reflection">
                            <h5>üí≠ Reflection:</h5>
                            <ul>
                                <li>How would my relationship with God change if I spent extended time with Him?</li>
                                <li>What barriers do I need to overcome to make prayer a lifestyle?</li>
                            </ul>
                            <textarea placeholder="Share your thoughts..." data-save-key="prayer_day_reflection"></textarea>
                            <div class="auto-save-label">
                                <span class="save-indicator" id="indicator_prayer_day_reflection"></span>
                                Auto-saved
                            </div>
                        </div>

                        <div class="activity">
                            <h5>üìù Additional Activity:</h5>
                            <ul>
                                <li>Plan a 2‚Äì3-hour prayer retreat using 30-minute segments.</li>
                                <li>Keep a journal for verses, prayers, and reflections during your prayer time.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Topic 2: Fellowship -->
        <div class="topic" id="topic2">
            <div class="topic-completion" id="topic2Completion"></div>
            <h2>Topic 2: Fellowship</h2>
            
            <p>Fellowship is the friendship and spiritual connection we share with other believers as we grow in Jesus together.</p>
            
            <div class="scripture">
                <p><strong>Hebrews 10:24-25</strong> - "Let us not give up meeting together... but encourage one another."</p>
            </div>
            
            <div class="key-point">
                <h4>What is Fellowship?</h4>
                <ul>
                    <li><strong>Fellowship with God</strong> ‚Äì our personal relationship with Him through Jesus</li>
                    <li><strong>Fellowship with others</strong> ‚Äì walking in love, unity, and purpose with fellow believers</li>
                </ul>
            </div>
            
            <!-- Importance of Fellowship -->
            <div class="collapsible-section">
                <button class="collapsible-header">
                    Importance of Fellowship
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div class="key-point">
                            <h4>1. We All Grow Together</h4>
                            <p>Just as flowers grow better together in a garden than alone, we can grow in our faith more with others who also love Jesus.</p>
                            <div class="scripture">
                                <p><strong>Proverbs 27:17</strong> - "Iron sharpens iron, so one person sharpens another."</p>
                            </div>
                        </div>
                        
                        <div class="key-point">
                            <h4>2. We Help Each Other</h4>
                            <p>When one friend is sad or struggling, other friends can pray with them, listen to them, and encourage them. We share joy and hard times with each other.</p>
                            <div class="scripture">
                                <p><strong>Galatians 6:2</strong> - "Bear one another's burdens, and so fulfill the law of Christ."</p>
                            </div>
                        </div>
                        
                        <div class="key-point">
                            <h4>3. We Learn From Each Other</h4>
                            <p>
                                We listen to multiple tellings of the Bible stories, sing songs, participate in activities, 
                                and learn how to follow Jesus together. Each time we gather, we share what we've learned, 
                                encourage one another, and grow stronger in our walk with Christ.
                            </p>
                            <div class="scripture">
                                <p><strong>üìñ Colossians 3:16</strong> ‚Äî "Let the word of Christ dwell in you richly in all wisdom, 
                                teaching and admonishing one another in psalms and hymns and spiritual songs, 
                                singing with grace in your hearts to the Lord."</p>
                            </div>
                        </div>
                        
                        <div class="key-point">
                            <h4>4. We Are All One Family</h4>
                            <p>God calls the church His family. We belong to God and we belong to each other.</p>
                            <div class="scripture">
                                <p><strong>1 Corinthians 12:27</strong> - "Now you are the body of Christ, and members individually."</p>
                            </div>
                        </div>
                        
                        <div class="key-point">
                            <h4>5. Jesus Is with Us</h4>
                            <p>Jesus promises that He will be with us when we meet in His name.</p>
                            <div class="scripture">
                                <p><strong>Matthew 18:20</strong> - "For where two or three gather in my name, there am I with them."</p>
                            </div>
                        </div>
                        
                        <div class="activity">
                            <h4>Additional Learner Activity: Fellowship & Reflection</h4>
                            <ol>
                                <li>
                                    <strong>Small Group Sharing:</strong>  
                                    In small groups, share one story of how Christian friends helped you during a hard or happy time.  
                                    <em>Reflect:</em> How did that fellowship remind you of God's love?
                                </li>
                                <li>
                                    <strong>Fellowship Chant (Call & Response Style):</strong>
                                    <div class="scripture mt-2">
                                        <p><strong>Leader:</strong> What's the focus of our fellowship?</p>
                                        <p><strong>Learners:</strong> Loving Jesus, walking it out!</p>
                                        <p><strong>Leader:</strong> We grow in faith and help one another‚Äî</p>
                                        <p><strong>Learners:</strong> Sisters and brothers, loving one another!</p>
                                        <p><strong>Leader:</strong> In Church or at the home,</p>
                                        <p><strong>Learners:</strong> We show God's love ‚Äî we're part of His family!</p>
                                        <p><strong>Leader:</strong> So let's be friends who care and pray ‚Äî</p>
                                        <p><strong>Learners:</strong> That's what God wants us to do each day!</p>
                                    </div>
                                    <p><em>Repeat twice to make it fun and memorable!</em></p>
                                </li>
                            </ol>

                            <div class="key-point mt-3">
                                <h5>Meaning of the Chant:</h5>
                                <ul>
                                    <li><strong>"Loving Jesus, living it out!"</strong> ‚Üí Fellowship is all about loving Jesus, and where we love Jesus, we show that love by the way we live.</li>
                                    <li><strong>"We grow in faith and help each other"</strong> ‚Üí In fellowship, we learn together, pray together, and encourage each other to draw closer to God.</li>
                                    <li><strong>"Sisters and brothers, loving one another!"</strong> ‚Üí As children of God, we are one big spiritual family. We care for one another the way real brothers and sisters in Christ do.</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="reflection">
                            <h4>Memory Verse with Actions</h4>
                            <div class="scripture">
                                <p><strong>Acts 2:42 (NIV)</strong> - "They devoted themselves to the apostles' teaching and to fellowship, to the breaking of bread and to prayer."</p>
                            </div>
                            <p><strong>Hand Motions:</strong></p>
                            <ul>
                                <li>"Teaching" (open book gesture)</li>
                                <li>"Fellowship" (link arms)</li>
                                <li>"Breaking bread" (pretend to break bread)</li>
                                <li>"Prayer" (hands together)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Characteristics of Biblical Fellowship -->
            <div class="collapsible-section">
                <button class="collapsible-header">
                    Characteristics of Biblical Fellowship
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div class="scripture">
                            <p><strong>John 13:34-35</strong> - "A new commandment I give to you, that you love one another; as I have loved you, that you also love one another. By this all will know that you are My disciples, if you have love for one another."</p>
                        </div>
                        
                        <div class="key-point">
                            <h4>Casual Friendship vs. Spiritual Fellowship</h4>
                            <table class="comparison-table">
                                <tr>
                                    <th>Casual Friendship</th>
                                    <th>Spiritual Fellowship</th>
                                </tr>
                                <tr>
                                    <td>Based on shared interests (games, school, fun)</td>
                                    <td>Based on shared faith in Christ</td>
                                </tr>
                                <tr>
                                    <td>Focus on fun and laughter</td>
                                    <td>Focuses on growth, support, and prayer</td>
                                </tr>
                                <tr>
                                    <td>Often surface-level</td>
                                    <td>Builds spiritual depth and character</td>
                                </tr>
                                <tr>
                                    <td>No prayer, no accountability</td>
                                    <td>Includes prayer, Bible encouragement, and care</td>
                                </tr>
                                <tr>
                                    <td>Temporary and easily fades</td>
                                    <td>Can last a lifetime and deepen over time</td>
                                </tr>
                            </table>
                        </div>
                        
                        <div class="reflection">
                            <h4>Reflection Questions</h4>
                            <p>Do you have friendships that appear to be more of a fellowship? What makes them different?</p>
                            <textarea placeholder="Share your thoughts..."></textarea>
                            <p>Why do you think God wants us to grow in fellowship instead of just friendships?</p>
                            <textarea placeholder="Share your thoughts..."></textarea>
                        </div>
                        
                        <div class="activity">
                            <h4>Activity: Encouragement Message</h4>
                            <p>Write a letter, text, or card encouraging someone in your fellowship group:</p>
                            <textarea placeholder="Write your encouraging message here..." style="width: 100%; min-height: 100px;"></textarea>
                            <button class="btn btn-fellowship" style="margin-top: 10px;">Save Message</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Accountability in Fellowship -->
            <div class="collapsible-section">
                <button class="collapsible-header">
                    Accountability in Fellowship
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div class="scripture">
                            <p><strong>Galatians 6:1-2</strong> - "Brothers and sisters, if someone is caught in a sin, you who live by the Spirit should restore that person gently. But watch yourselves, or you also may be tempted. Carry each other's burdens, and in this way, you will fulfill the law of Christ."</p>
                        </div>
                        
                        <div class="key-point">
                            <h4>What is Accountability?</h4>
                            <p>"Accountability means helping each other stay close to God and grow in faith. It means checking in, correcting with love, and encouraging each other when we stumble."</p>
                        </div>
                        
                        <div class="key-point">
                            <h4>Key Principles</h4>
                            <ul>
                                <li><strong>Gentleness:</strong> "Restore that person gently" - never harsh, embarrassing, or forceful</li>
                                <li><strong>Burden-bearing:</strong> Praying with friends who are struggling, listening without gossip, helping make better decisions</li>
                                <li><strong>Humility:</strong> "Watch yourselves" - be careful not to fall into the same sin while helping others</li>
                                <li><strong>Same-Gender Accountability:</strong> Important for creating safe boundaries and avoiding distractions</li>
                            </ul>
                        </div>
                        
                        <div class="activity">
                            <h4>Activity: Accountability Partners</h4>
                            <p>Form accountability pairs or triads (groups of 2-3 learners) within the same gender.</p>
                            <p><strong>Ways to practice:</strong></p>
                            <ul>
                                <li>Choose same-gender partners for prayer and check-ins</li>
                                <li>Check in on each other spiritually - ask how Bible reading is going, share prayer requests</li>
                                <li>Practice respect, confidentiality, and encouraging words</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Serving Together -->
            <div class="collapsible-section">
                <button class="collapsible-header">
                    Serving Together
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div class="scripture">
                            <p><strong>1 Peter 4:10 (NKJV)</strong> - "As each one has received a gift, minister it to one another, as good stewards of the manifold grace of God."</p>
                        </div>
                        
                        <div class="key-point">
                            <h4>Why Serve Together?</h4>
                            <ul>
                                <li>Serving is an act of love and obedience - reflecting Christ to others</li>
                                <li>Fellowship includes working side-by-side to bless others</li>
                                <li>Serving deepens friendships and builds unity</li>
                                <li>Everyone has unique gifts to contribute</li>
                            </ul>
                        </div>
                        
                        <div class="activity">
                            <h4>Service Project Ideas</h4>
                            <ul>
                                <li>Visiting the sick or elderly</li>
                                <li>Cleaning the church or helping with Sunday School</li>
                                <li>Collecting food or clothing for needy families</li>
                                <li>Writing thank-you notes for pastors, teachers, or parents</li>
                            </ul>
                        </div>
                        
                        <div class="key-point">
                            <h4>Real Story: The Sandwich Team</h4>
                            <p>In a small church youth group in Nairobi, the idea of community service was born in simple terms. Every Saturday after Bible study, the kids would pool their money to buy bread, peanut butter, and bananas.</p>
                            <p>They made 20 sandwiches, put them in paper bags, and walked right down to a street corner where they knew some children were living begging for food. A little Bible verse was handed out with each sandwich, and the kids prayed with anyone who wanted prayer.</p>
                            <p>Initially, it seemed so small and simple, but gradually, the community took notice. One of the street boys has started coming to church, and another went back to school upon encouragement and assistance offered. The youth group became famous for kindness, and more kids evidenced their commitment to being engaged.</p>
                            <p><strong>üëâ A few sandwiches turned into a big movement for hope!</strong></p>
                        </div>
                        
                        <div class="activity">
                            <h4>Activity: Spiritual Gift Match</h4>
                            <p>List your skills or what you enjoy doing. Discuss how each one can be used to serve others.</p>
                            <textarea placeholder="My skills and interests..."></textarea><br>
                            <button class="btn btn-fellowship" style="margin-top: 10px;">Save My Gifts</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Group Activity: Fellowship Map -->
            <div class="collapsible-section">
                <button class="collapsible-header">
                    Group Activity: Fellowship Map
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div class="scripture">
                            <p><strong>Ecclesiastes 4:9-10</strong> - "Two are better than one, because they have a good return for their labor: If either of them falls down, one can help the other up. But pity anyone who falls and has no one to help them up."</p>
                        </div>
                        
                        <div class="fellowship-map-container">
                            <div class="fellowship-map-circle">
                                <div class="fellowship-center">ME</div>
                                <div class="fellowship-category fellowship-mentors">
                                    <h5>Mentors</h5>
                                    <p>Older or mature believers who guide me</p>
                                </div>
                                <br>
                                <br>
                                <div class="fellowship-category fellowship-peers">
                                    <h5>Peers</h5>
                                    <p>Christian friends who walk with me in faith</p>
                                </div>
                                <br>
                                <br>
                                <div class="fellowship-category fellowship-mentees">
                                    <h5>Mentees</h5>
                                    <p>Younger or newer believers I can encourage</p>
                                </div>
                                 <br>
                                <br>
                                <div class="fellowship-category fellowship-others">
                                    <h5>Others</h5>
                                    <p>Additional spiritual relationships</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="activity">
                            <h4>Create Your Fellowship Map</h4>
                            <p>Draw your own Fellowship Map showing your current spiritual community:</p>
                            <div style="text-align: center; margin: 20px 0;">
                                <div style="width: 300px; height: 300px; border: 2px dashed #ccc; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center;">
                                    <span style="color: #999;">Draw your fellowship map here</span>
                                </div>
                            </div>
                            
                            <div class="reflection">
                                <h5>Reflection Questions:</h5>
                                <p>Who encourages me? Who am I encouraging?</p>
                                <textarea placeholder="Share your thoughts..."></textarea>
                                <p>Are there any missing areas in my fellowship map?</p>
                                <textarea placeholder="Share your thoughts..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Navigation Buttons -->
        <div class="lesson-nav">
            <a href="module-lesson1.html" class="btn btn-outline">
                <i class="fas fa-arrow-left"></i> Previous Lesson
            </a>
            <a href="module-lesson3.html" class="btn">
                Next Lesson <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </div>
    
    <!-- NEW: Back to top button -->
    <div class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </div>
    
    <!-- Bottom Navigation Bar -->
    <div class="bottom-nav">
        <a href="../progress.html" class="nav-item">
            <span class="nav-icon">üìä</span>
            <span>Dashboard</span>
        </a>
        <a href="lessons.html" class="nav-item active">
            <span class="nav-icon">üìö</span>
            <span>Lessons</span>
        </a>
        <a href="prayer.html" class="nav-item">
            <span class="nav-icon">üôè</span>
            <span>Prayer</span>
        </a>
        <a href="#" id="logoutBtn" class="nav-item">
            <span class="nav-icon">üö™</span>
            <span>Logout</span>
        </a>
    </div>
    
    <!-- Sync Status -->
    <div class="sync-status" id="syncStatus">Checking connection...</div>
    
    <!-- Auto-save notification -->
    <div class="save-notification" id="saveNotification">
        <i class="fas fa-check-circle"></i> Progress saved
    </div>
    
    <footer>
        <p>Pathlight Discipleship Curriculum &copy; 2023 | KCMC</p>
        <p>Lit to Lead. Rooted to Grow.</p>
    </footer>

    <!-- Firebase SDK -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js';
        import { getFirestore, doc, setDoc, getDoc, onSnapshot } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js';

        // Firebase configuration
        const firebaseConfig = {
            // Add your Firebase configuration here
            apiKey: "your-api-key",
            authDomain: "your-auth-domain",
            projectId: "your-project-id",
            storageBucket: "your-storage-bucket",
            messagingSenderId: "your-messaging-sender-id",
            appId: "your-app-id"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // Enhanced Progress tracking and auto-save functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize progress tracking
            const enhancedProgressBar = document.getElementById('enhancedProgressBar');
            const progressText = document.getElementById('progressText');
            const lastSaved = document.getElementById('lastSaved');
            const saveNotification = document.getElementById('saveNotification');
            
            // Get all form fields
            const formFields = document.querySelectorAll('textarea, input[type="text"]');
            
            // Collapsible sections with scrollable content
            const collapsibleHeaders = document.querySelectorAll('.collapsible-header');
            collapsibleHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const content = this.nextElementSibling;
                    if (content.classList.contains('active')) {
                        content.classList.remove('active');
                        content.style.maxHeight = null;
                    } else {
                        content.classList.add('active');
                        content.style.maxHeight = content.scrollHeight + "px";
                    }
                });
            });
            
            // Topic completion toggle
            const completionElements = document.querySelectorAll('.topic-completion');
            completionElements.forEach(element => {
                element.addEventListener('click', function() {
                    this.classList.toggle('topic-completed');
                    updateEnhancedProgress();
                    saveProgress();
                });
            });
            
            // Load saved data from localStorage
            loadSavedData();
            
            // Calculate initial progress
            updateEnhancedProgress();
            
            // Add event listeners to all form fields
            formFields.forEach(field => {
                field.addEventListener('input', function() {
                    // Save data to localStorage
                    saveData();
                    
                    // Update progress
                    updateEnhancedProgress();
                    
                    // Show save notification
                    showSaveNotification();
                });
            });
            
            // NEW: Dark mode toggle
            const darkModeToggle = document.getElementById('darkModeToggle');
            darkModeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark-mode');
                const isDarkMode = document.body.classList.contains('dark-mode');
                localStorage.setItem('darkMode', isDarkMode);
                darkModeToggle.innerHTML = isDarkMode ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
            });
            
            // Load dark mode preference
            const savedDarkMode = localStorage.getItem('darkMode') === 'true';
            if (savedDarkMode) {
                document.body.classList.add('dark-mode');
                darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            }
            
            // NEW: Back to top button
            const backToTop = document.getElementById('backToTop');
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    backToTop.classList.add('visible');
                } else {
                    backToTop.classList.remove('visible');
                }
            });
            
            backToTop.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
            
            // NEW: Quick navigation toggle
            const quickNavToggle = document.getElementById('quickNavToggle');
            const quickNav = document.getElementById('quickNav');
            quickNavToggle.addEventListener('click', function() {
                quickNav.classList.toggle('active');
            });
            
            // Function to save data to localStorage
            function saveData() {
                const data = {};
                
                formFields.forEach(field => {
                    const saveKey = field.getAttribute('data-save-key');
                    
                    if (saveKey) {
                        data[saveKey] = field.value;
                    }
                });
                
                localStorage.setItem('lesson2Data', JSON.stringify(data));
                
                // Update last saved time
                const now = new Date();
                lastSaved.textContent = now.toLocaleTimeString();
                localStorage.setItem('lesson2SavedTime', now.toLocaleTimeString());
                
                // Save to Firestore if user is authenticated
                if (auth.currentUser) {
                    saveToFirestore(data);
                }
            }
            
            // Function to save data to Firestore
            async function saveToFirestore(data) {
                try {
                    const user = auth.currentUser;
                    if (user) {
                        const userRef = doc(db, 'users', user.uid, 'lessons', 'lesson2');
                        await setDoc(userRef, {
                            data: data,
                            lastUpdated: new Date(),
                            progress: calculateProgress()
                        });
                        updateSyncStatus('synced');
                    }
                } catch (error) {
                    console.error('Error saving to Firestore:', error);
                    updateSyncStatus('local');
                }
            }
            
            // Function to load saved data from localStorage and Firestore
            async function loadSavedData() {
                // First load from localStorage
                const savedData = localStorage.getItem('lesson2Data');
                
                if (savedData) {
                    const data = JSON.parse(savedData);
                    
                    formFields.forEach(field => {
                        const saveKey = field.getAttribute('data-save-key');
                        
                        if (saveKey && data[saveKey]) {
                            field.value = data[saveKey];
                        }
                    });
                    
                    // Update last saved time
                    const savedTime = localStorage.getItem('lesson2SavedTime');
                    if (savedTime) {
                        lastSaved.textContent = savedTime;
                    }
                }
                
                // Then try to load from Firestore
                try {
                    const user = auth.currentUser;
                    if (user) {
                        const userRef = doc(db, 'users', user.uid, 'lessons', 'lesson2');
                        const docSnap = await getDoc(userRef);
                        
                        if (docSnap.exists()) {
                            const firestoreData = docSnap.data();
                            
                            // Merge Firestore data with localStorage data
                            formFields.forEach(field => {
                                const saveKey = field.getAttribute('data-save-key');
                                
                                if (saveKey && firestoreData.data[saveKey]) {
                                    field.value = firestoreData.data[saveKey];
                                }
                            });
                            
                            // Update last saved time
                            if (firestoreData.lastUpdated) {
                                const firestoreTime = firestoreData.lastUpdated.toDate().toLocaleTimeString();
                                lastSaved.textContent = firestoreTime;
                            }
                            
                            updateSyncStatus('synced');
                        } else {
                            updateSyncStatus('local');
                        }
                    }
                } catch (error) {
                    console.error('Error loading from Firestore:', error);
                    updateSyncStatus('local');
                }
            }
            
            // Function to update enhanced progress bar
            function updateEnhancedProgress() {
                let completedFields = 0;
                
                formFields.forEach(field => {
                    if (field.value.trim() !== '') {
                        completedFields++;
                    }
                });
                
                const totalFields = formFields.length;
                const progressPercentage = Math.round((completedFields / totalFields) * 100);
                
                enhancedProgressBar.style.width = `${progressPercentage}%`;
                enhancedProgressBar.textContent = `${progressPercentage}%`;
                progressText.textContent = `${progressPercentage}%`;
                
                // Update original progress bar
                updateProgressBar();
                
                // Save progress to localStorage
                localStorage.setItem('lesson2EnhancedProgress', progressPercentage);
                
                // Calculate and return progress for Firestore
                return progressPercentage;
            }
            
            // Original progress bar function (preserved)
            function updateProgressBar() {
                const completedTopics = document.querySelectorAll('.topic-completed').length;
                const totalTopics = document.querySelectorAll('.topic-completion').length;
                const progressPercentage = (completedTopics / totalTopics) * 100;
                
                document.getElementById('progressBar').style.width = progressPercentage + '%';
            }
            
            function saveProgress() {
                const topics = [];
                document.querySelectorAll('.topic-completion').forEach((element, index) => {
                    topics.push({
                        id: index,
                        completed: element.classList.contains('topic-completed')
                    });
                });
                
                localStorage.setItem('lesson2Progress', JSON.stringify(topics));
            }
            
            function loadProgress() {
                const savedProgress = localStorage.getItem('lesson2Progress');
                if (savedProgress) {
                    const topics = JSON.parse(savedProgress);
                    topics.forEach(topic => {
                        const element = document.querySelectorAll('.topic-completion')[topic.id];
                        if (element && topic.completed) {
                            element.classList.add('topic-completed');
                        }
                    });
                    updateProgressBar();
                }
            }
            
            // Function to show save notification
            function showSaveNotification() {
                saveNotification.classList.add('show');
                
                setTimeout(() => {
                    saveNotification.classList.remove('show');
                }, 2000);
            }
            
            // Function to update sync status
            function updateSyncStatus(status) {
                const syncStatus = document.getElementById('syncStatus');
                
                switch(status) {
                    case 'syncing':
                        syncStatus.textContent = 'Syncing...';
                        syncStatus.className = 'sync-status syncing';
                        break;
                    case 'synced':
                        syncStatus.textContent = 'Synced to cloud';
                        syncStatus.className = 'sync-status synced';
                        break;
                    case 'local':
                        syncStatus.textContent = 'Saved locally';
                        syncStatus.className = 'sync-status local';
                        break;
                    case 'offline':
                        syncStatus.textContent = 'Offline - Changes saved locally';
                        syncStatus.className = 'sync-status offline';
                        break;
                    default:
                        syncStatus.textContent = 'Checking connection...';
                        syncStatus.className = 'sync-status';
                }
            }
            
            // Online/offline detection
            window.addEventListener('online', function() {
                updateSyncStatus('syncing');
                // Try to sync data when coming back online
                saveData();
            });
            
            window.addEventListener('offline', function() {
                updateSyncStatus('offline');
            });
            
            // Auto-save every 30 seconds as a backup
            setInterval(saveData, 30000);
            
            // Load saved progress if available
            const savedEnhancedProgress = localStorage.getItem('lesson2EnhancedProgress');
            if (savedEnhancedProgress) {
                enhancedProgressBar.style.width = `${savedEnhancedProgress}%`;
                enhancedProgressBar.textContent = `${savedEnhancedProgress}%`;
                progressText.textContent = `${savedEnhancedProgress}%`;
            }
            
            // Load original progress
            loadProgress();
            
            // Initialize sync status
            if (navigator.onLine) {
                updateSyncStatus('synced');
            } else {
                updateSyncStatus('offline');
            }
            
            // Logout functionality
            document.getElementById('logoutBtn').addEventListener('click', function(event) {
                event.preventDefault();
                if (confirm('Are you sure you want to logout?')) {
                    // In a real app, this would clear authentication tokens
                    // and redirect to login page
                    alert('You have been logged out successfully.');
                    
                    setTimeout(() => {
                        // Simulate logout - in a real app, redirect to login
                        window.location.href = '../index.html';
                    }, 1500);
                }
            });
            
            // Listen for auth state changes
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    // User is signed in
                    updateSyncStatus('synced');
                    // Load data from Firestore
                    loadSavedData();
                } else {
                    // User is signed out
                    updateSyncStatus('local');
                }
            });
        });
    </script>
</body>
</html>