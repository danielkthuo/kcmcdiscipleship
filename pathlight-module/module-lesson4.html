<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 4: Doctrine - Pathlight Curriculum</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
     <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#2c3e50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="KCM Church">
    <meta name="description" content="Discipleship Tool for Kingdom Covenant Ministries Church">
    <meta name="keywords" content="church, discipleship, christian, ministry">
    <meta name="author" content="Kingdom Covenant Ministries Church">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="icons/icon-152x152.png">
    <link rel="apple-touch-startup-image" href="icons/icon-512x512.png">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Viewport for mobile optimization -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <!-- Preload important resources -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com/ajax.googleapis.com">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --success-color: #2ecc71;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-main);
            line-height: 1.6;
            color: #333;
            background-color: #f9f9f9;
            padding-bottom: 80px; /* Space for bottom nav */
            -webkit-text-size-adjust: 100%; /* Prevent font scaling in landscape */
        }
        
        .container {
            width: 100%;
            margin: 0 auto;
            padding: 15px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1.5rem 0;
            text-align: center;
            margin-bottom: 1.5rem;
            position: relative;
            width: 100%;
        }
        
        .header-content {
            width: 100%;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }
        
        .lesson-nav {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            gap: 10px;
        }
        
        .btn {
            display: inline-block;
            background-color: var(--secondary-color);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            text-align: center;
            flex: 1;
            min-height: 48px; /* Minimum touch target size */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn:hover {
            background-color: var(--primary-color);
        }
        
        .topic {
            background-color: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: relative;
            width: 100%;
        }
        
        .topic h2 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.5rem;
            font-size: 1.4rem;
        }
        
        .topic h5 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .scripture {
            background-color: #f8f9fa;
            border-left: 4px solid var(--secondary-color);
            padding: 1rem;
            margin: 1rem 0;
            font-style: italic;
            border-radius: 0 8px 8px 0;
        }
        
        .key-point {
            background-color: #e8f4fc;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .key-point h4 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        
        .doctrine-table, .role-table, .baptism-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            display: block;
            overflow-x: auto;
            white-space: nowrap;
        }
        
        .doctrine-table th, .doctrine-table td,
        .role-table th, .role-table td,
        .baptism-table th, .baptism-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .doctrine-table th {
            background-color: var(--primary-color);
            color: white;
        }
        
        .role-table th {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .baptism-table th {
            background-color: #2e7d32;
            color: white;
        }
        
        .doctrine-table tr:nth-child(even),
        .role-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .activity {
            background-color: #fff8e1;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }
        
        .activity h4 {
            color: #e65100;
            margin-bottom: 0.5rem;
        }
        
        .facilitator-notes {
            background-color: #e8f5e9;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid #4caf50;
        }
        
        .facilitator-notes h4 {
            color: #2e7d32;
            margin-bottom: 1rem;
        }
        
        .identity-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        
        .identity-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border-left: 4px solid var(--secondary-color);
            width: 100%;
        }
        
        .fruit-tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }
        
        .tree-trunk {
            width: 50px;
            height: 100px;
            background-color: #8B4513;
            margin-bottom: 10px;
        }
        
        .tree-top {
            width: 180px;
            height: 160px;
            background-color: #2E8B57;
            border-radius: 100px;
            position: relative;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }
        
        .fruit {
            background-color: #FF6B6B;
            color: white;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            font-weight: bold;
            margin: 4px;
            text-align: center;
        }
        
        footer {
            text-align: center;
            margin-top: 3rem;
            padding: 1.5rem;
            background-color: var(--dark-color);
            color: white;
            border-radius: 12px;
            width: 100%;
        }
        
        /* Collapsible sections with scrollable content */
        .collapsible {
            background-color: #f1f1f1;
            color: var(--primary-color);
            cursor: pointer;
            padding: 14px 18px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1rem;
            font-weight: 500;
            border-radius: 8px;
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
            min-height: 48px; /* Minimum touch target size */
        }
        
        .collapsible:hover {
            background-color: #e8f4fc;
        }
        
        .collapsible::after {
            content: '+';
            font-weight: bold;
            font-size: 1.1rem;
            transition: transform 0.3s;
            color: var(--primary-color);
        }
        
        .collapsible.active::after {
            content: '–';
            transform: rotate(180deg);
        }
        
        .content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: #ffffff;
            border-radius: 0 0 8px 8px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
            padding: 0 16px;
        }
        
        .content.open {
            max-height: 400px; /* Set a maximum height for scrollable sections */
            overflow-y: auto; /* Enable vertical scrolling */
            padding: 15px;
            border: 1px solid #e1e1e1;
            border-top: none;
        }
        
        /* Custom scrollbar for content */
        .content.open::-webkit-scrollbar {
            width: 8px;
        }
        
        .content.open::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .content.open::-webkit-scrollbar-thumb {
            background: var(--secondary-color);
            border-radius: 4px;
        }
        
        .content.open::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }
        
        /* Progress Bar Styles */
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .progress-bar {
            height: 20px;
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
            width: 0%;
            border-radius: 10px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 14px;
            color: #666;
        }
        
        /* Auto-save notification */
        .save-notification {
            position: fixed;
            bottom: 70px;
            right: 15px;
            background-color: var(--success-color);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
            font-size: 0.9rem;
        }
        
        .save-notification.show {
            opacity: 1;
        }
        
        /* Topic completion indicator */
        .topic-completion {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--success-color);
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .topic-completion.visible {
            opacity: 1;
        }
        
        /* Form field styling */
        textarea, input[type="text"] {
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-family: var(--font-main);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            width: 100%;
            font-size: 16px; /* Prevent zoom on iOS */
        }
        
        textarea:focus, input[type="text"]:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: white;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #666;
            font-size: 0.8rem;
            padding: 5px 10px;
            border-radius: 5px;
            transition: all 0.3s ease;
            min-height: 48px; /* Minimum touch target size */
            justify-content: center;
        }
        
        .nav-item.active {
            color: var(--secondary-color);
            background-color: #e8f4fc;
        }
        
        .nav-icon {
            font-size: 1.2rem;
            margin-bottom: 3px;
        }
        
        /* Sync status styles */
        .sync-status {
                        position: fixed;
                        top: 10px;
                        right: 10px;
                        background: rgba(255,255,255,0.9);
                        padding: 5px 10px;
                        border-radius: 20px;
                        font-size: 0.8rem;
                        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                        z-index: 1000;
                        display: flex;
                        align-items: center;
                        gap: 5px;
                        transition: all 0.3s ease;
                    }
                    .sync-status.syncing {
                        color: #f39c12;
                    }
                    .sync-status.synced {
                        color: #2ecc71;
                    }
                    .sync-status.error {
                        color: #e74c3c;
                    }
                    @media (max-width: 768px) {
                        .sync-status {
                            top: 5px;
                            right: 5px;
                            font-size: 0.75rem;
                            padding: 4px 8px;
                        }
                    }
                
        
        /* Manual sync button */
        #manualSync {
            position: fixed;
            bottom: 70px;
            right: 15px;
            background: var(--secondary-color, #3498db);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            font-size: 1.2rem;
        }
        
        /* Mobile-specific improvements */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header {
                padding: 1rem 0;
                margin-bottom: 1rem;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .topic {
                padding: 1rem;
                margin-bottom: 1rem;
            }
            
            .topic h2 {
                font-size: 1.2rem;
            }
            
            .topic h5 {
                font-size: 1.1rem;
            }
            
            .btn {
                padding: 14px 16px;
                font-size: 0.9rem;
            }
            
            .tree-top {
                width: 160px;
                height: 140px;
            }
            
            .fruit {
                width: 40px;
                height: 40px;
                font-size: 8px;
            }
            
            .tree-trunk {
                width: 40px;
                height: 80px;
            }
            
            .save-notification {
                bottom: 60px;
                right: 10px;
                left: 10px;
                text-align: center;
            }
            
            /* Adjust scrollable content height for mobile */
            .content.open {
                max-height: 300px;
            }
            
            .sync-status {
                top: 5px;
                right: 5px;
                left: 5px;
                max-width: none;
                text-align: center;
            }
        }
        
        @media (min-width: 769px) {
            .container {
                max-width: 100%;
            }
            
            .identity-list {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .identity-item {
                flex: 1;
                min-width: 200px;
            }
            
            /* Adjust scrollable content height for larger screens */
            .content.open {
                max-height: 500px;
            }
        }
        
        /* Prevent horizontal scrolling */
        html, body {
            max-width: 100%;
            overflow-x: hidden;
        }
        
        /* Improve touch interactions */
        button, .btn, .nav-item, .topic-completion {
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        /* Improve text readability on mobile */
        p, li, td, th {
            font-size: 16px;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <br>
            <h1>Lesson 4: Doctrine</h1>
            <p>Essential Christian teachings for a solid theological foundation</p>
        </div>
    </header>
    
    <div class="container">
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>
        <div class="progress-info">
            <span>Progress: <span id="progressText">0%</span></span>
            <span>Last saved: <span id="lastSaved">Not saved yet</span></span>
        </div>
        
        <div class="lesson-nav">
            <a href="module-lesson3.html" class="btn">Previous Lesson</a>
            <a href="../progress.html" class="btn">Dashboard</a>
          
            <a href="module-lesson5.html" class="btn">Next Lesson</a>
        </div>
        
        <div class="topic" id="topic1">
            <div class="topic-completion" id="topic1Complete">✓</div>    
            <h5>Topic 1: The Doctrine of Jesus (Christology)</h5>   
            <div class="scripture">
                <p><strong>John 14:6 (NKJV)</strong> - "Jesus said to him, 'I am the way, the truth, and the life. No one comes to the Father except through Me.'"</p>
            </div>
            
            <div class="facilitator-notes">
                <h4>Facilitator Notes</h4>
                <p><strong>Objective:</strong> To help students understand that Jesus is fully God and fully man, the Son of God, Savior of the world, and the center of the Christian faith.</p>
                <p><strong>Key Scriptures:</strong> John 1:1-3, 14; Colossians 1:15-20; Philippians 2:5-11</p>
            </div>
            
            <div class="collapsible">He Is Eternal</div>
            <div class="content">
                <h3>1. Jesus Existed Before Creation — He Is Eternal</h3>
                <div class="scripture">
                    <p><strong>John 1:1-3 (NKJV)</strong> - "In the beginning was the Word, and the Word was with God, and the Word was God. He was in the beginning with God. All things were made through Him, and without Him nothing was made that was made."</p>
                </div>
                <div class="key-point">
                    <h4>Key Teaching Points:</h4>
                    <p>"The Word" in our passage is referring to Jesus. Jesus didn't begin to exist when He was born in Bethlehem—He was with God in the beginning. He helped to create the world & all things were made through Him.</p>
                    <p><strong>Why it Matters:</strong> Jesus is not just a good man or a teacher — He is God. We can trust Him because He existed before time began.</p>
                </div>
            </div>
            
            <div class="collapsible">He is exact God</div>
            <div class="content">
                <h3>2. Jesus Took on Human Flesh to Live Among Us</h3>
                <div class="scripture">
                    <p><strong>John 1:14 (NKJV)</strong> - "And the Word became flesh and dwelt among us, and we beheld His glory, the glory as of the only begotten of the Father, full of grace and truth."</p>
                </div>
                <div class="key-point">
                    <h4>Key Teaching Points:</h4>
                    <p>Jesus was born as a baby (Luke chapter 2). He grew, ate, even felt sad, got tired—just like us. Jesus, who is God, came down to earth and became human. "Made His dwelling" means He came to live with us - like setting up a tent to stay. Jesus was 100% God and 100% man—the big word for this is Incarnation.</p>
                    <p><strong>Why It Matters:</strong> Jesus isn't far away. He came close. He knows what it's like to be human — to be hungry, tired, happy, or sad.</p>
                </div>
                
                <h3>3. He Is the Exact Image of God</h3>
                <div class="scripture">
                    <p><strong>Colossians 1:15 (NKJV)</strong> - "He is the image of the invisible God, the firstborn over all creation."</p>
                </div>
                <div class="key-point">
                    <h4>Key Teaching Points:</h4>
                    <p>If you want to know what God looks like, how He thinks, acts, or feels—look at Jesus. "Image" means exact likeness. Jesus reveals God to us.</p>
                    <p><strong>Why It Matters:</strong> Jesus helps us know and understand who God really is. We don't have to guess what God is like — we see it in how Jesus loved, forgave, and helped people.</p>
                </div>
            </div>
            
            <div class="collapsible">He Understands Our Struggles</div>
            <div class="content">
                <h3>4. Jesus Understands Our Struggles</h3>
                <div class="scripture">
                    <p><strong>Hebrews 4:15 (NKJV)</strong> - "For we do not have a High Priest who cannot sympathize with our weaknesses, but was in all points tempted as we are, yet without sin."</p>
                </div>
                <div class="key-point">
                    <h4>Key Teaching Points:</h4>
                    <p>Jesus lived as a human in the same way we do—He experienced temptation, sadness, rejection, and pain as we do. And yet He did not sin - which makes Him the perfect helper.</p>
                    <p><strong>Why It Matters:</strong> When you're struggling, tempted, or hurt — Jesus knows what that feels like. He invites you to come to Him in prayer - He is personally kind, patiently waiting, and an all-powerful helper.</p>
                </div>
            </div>
            
            <div class="collapsible">Summary and Response</div>
            <div class="content">
                <h3>Summary Chart</h3>
                <table class="doctrine-table">
                    <thead>
                        <tr>
                            <th>Truth about Jesus</th>
                            <th>Bible Reference</th>
                            <th>What It Teaches</th>
                            <th>Why It Matters</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Jesus is eternal</td>
                            <td>John 1:1-3</td>
                            <td>He existed before creation - He is God</td>
                            <td>We can fully trust Him</td>
                        </tr>
                        <tr>
                            <td>Jesus became human</td>
                            <td>John 1:14</td>
                            <td>God came to live among us</td>
                            <td>He came close to save and understand us</td>
                        </tr>
                        <tr>
                            <td>Jesus is the image of God</td>
                            <td>Colossians 1:15</td>
                            <td>Jesus shows us what God is like</td>
                            <td>We don't have to guess who God is</td>
                        </tr>
                        <tr>
                            <td>Jesus understands our struggles</td>
                            <td>Hebrews 4:15</td>
                            <td>He faced temptation and pain</td>
                            <td>He can help us in our struggles</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="key-point">
                    <h4>Summary:</h4>
                    <p>Jesus is fully God and fully man. He existed before creation, became human to save us, reveals God perfectly, and understands everything we go through.</p>
                </div>
                
                <div class="key-point">
                    <h4>What to Do with the Name of Jesus:</h4>
                    <ol>
                        <li><strong>Believe in His Name</strong> - John 1:12</li>
                        <li><strong>Pray in His Name</strong> - John 14:13</li>
                        <li><strong>Live for His Name</strong> - Colossians 3:17</li>
                        <li><strong>Tell Others About His Name</strong> - Acts 4:12</li>
                    </ol>
                </div>
            </div>
            
            <div class="collapsible">Activity</div>
            <div class="content">
                <div class="activity">
                    <h4>Reflection Activity</h4>
                    <p>What will you do next with what you've learned about Jesus?</p>
                    <p><strong>I will:</strong></p>
                    <textarea placeholder="Write your commitment here..." style="width: 100%; min-height: 80px; margin-top: 10px;" data-topic="1" data-question="1"></textarea>
                </div>
            </div>
        </div>
        
        <div class="topic" id="topic2">
            <div class="topic-completion" id="topic2Complete">✓</div>           
            <h5>Topic 2: The Doctrine of Holy Spirit (Pneumatology)</h5>

            <div class="scripture">
                <p><strong>John 14:16-17 (NKJV)</strong> - "And I will pray the Father, and He will give you another Helper, that He may abide with you forever— the Spirit of truth, whom the world cannot receive..."</p>
            </div>
            
            <div class="key-point">
                <h4>Who Is the Holy Spirit?</h4>
                <p>The Holy Spirit is <strong>God</strong>—the third person of the Trinity. He is not a feeling or a force; He is a real Person, living in us and working through us.</p>
            </div>
            
            <div class="collapsible">Key Truths</div>
            <div class="content">
                <h3>Key Truths About the Holy Spirit:</h3>
                
                <div class="key-point">
                    <h4>1. The Holy Spirit Is God</h4>
                    <p><strong>Acts 5:3-4</strong> - Lying to the Holy Spirit is lying to God</p>
                    <p><strong>Matthew 28:19</strong> - Baptized in the name of the Father, Son, and Holy Spirit</p>
                </div>
                
                <div class="key-point">
                    <h4>2. The Holy Spirit Is a Person—Not a Force</h4>
                    <ul>
                        <li><strong>Mind</strong> - He knows and teaches (1 Corinthians 2:10-11)</li>
                        <li><strong>Emotions</strong> - He can be grieved (Ephesians 4:30)</li>
                        <li><strong>Will</strong> - He distributes gifts as He wills (1 Corinthians 12:11)</li>
                    </ul>
                </div>
                
                <div class="key-point">
                    <h4>3. He Is Eternal, All-Powerful, Holy, and Always Present</h4>
                    <p><strong>Genesis 1:2</strong> - Present at creation</p>
                    <p><strong>Hebrews 9:14</strong> - Called the eternal Spirit</p>
                </div>
                
                <div class="key-point">
                    <h4>4. The Holy Spirit Is Part of the Trinity</h4>
                    <p>God is one being in three persons: <strong>Father</strong>, <strong>Son</strong> (Jesus), <strong>Holy Spirit</strong>—each fully God, yet individually different.</p>
                </div>
            </div>
            
            <div class="collapsible">His Work</div>
            <div class="content">
                <h3>What Does the Holy Spirit Do?</h3>
                
                <table class="role-table">
                    <thead>
                        <tr>
                            <th>Role</th>
                            <th>Explanation</th>
                            <th>Bible Reference</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Helper/Comforter</td>
                            <td>Gives strength, courage, and comfort</td>
                            <td>John 14:16</td>
                        </tr>
                        <tr>
                            <td>Teacher</td>
                            <td>Helps understand God's Word</td>
                            <td>John 14:26</td>
                        </tr>
                        <tr>
                            <td>Convicts of Sin</td>
                            <td>Helps know right from wrong</td>
                            <td>John 16:8</td>
                        </tr>
                        <tr>
                            <td>Guide</td>
                            <td>Leads in truth and helps make choices</td>
                            <td>Romans 8:14</td>
                        </tr>
                        <tr>
                            <td>Empowerer</td>
                            <td>Gives boldness and power to serve</td>
                            <td>Acts 1:8</td>
                        </tr>
                        <tr>
                            <td>Seal & Guarantee</td>
                            <td>Marks us as God's own</td>
                            <td>Ephesians 1:13-14</td>
                        </tr>
                        <tr>
                            <td>Fruit Producer</td>
                            <td>Grows godly character</td>
                            <td>Galatians 5:22-23</td>
                        </tr>
                        <tr>
                            <td>Gives Spiritual Gifts</td>
                            <td>Equips believers with unique gifts</td>
                            <td>1 Corinthians 12:4-7</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="collapsible">Activity</div>
            <div class="content">
                <div class="activity">
                    <h4>Activity: Fruit of the Spirit Tree</h4>
                    <p>Draw a tree and label each fruit listed in Galatians 5:22-23. Write one way to grow that fruit this week.</p>
                    
                    <div class="fruit-tree">
                        <div class="tree-top">
                            <div class="fruit">Love</div>
                            <div class="fruit">Joy</div>
                            <div class="fruit">Peace</div>
                            <div class="fruit">Patience</div>
                            <div class="fruit">Kindness</div>
                            <div class="fruit">Goodness</div>
                            <div class="fruit">Faithfulness</div>
                            <div class="fruit">Gentleness</div>
                            <div class="fruit">Self-Control</div>
                        </div>
                        <div class="tree-trunk"></div>
                    </div>
                    
                    <p><strong>Which fruit do you need to work on this week?</strong></p>
                    <textarea placeholder="Write your response here..." style="width: 100%; min-height: 60px; margin-top: 10px;" data-topic="2" data-question="1"></textarea>
                </div>
            </div>
            
            <div class="collapsible">What Happens When We Receive the Holy Spirit?</div>
            <div class="content">
                <div class="key-point">
                    <h4>What Happens When We Receive the Holy Spirit?</h4>
                    <ol>
                        <li>We become a dwelling place for God (1 Corinthians 6:19)</li>
                        <li>We are spiritually reborn (John 3:5-6)</li>
                        <li>We receive power to live for God (Acts 1:8)</li>
                        <li>We bear spiritual fruit (Galatians 5:22-23)</li>
                        <li>We are guided and taught (John 14:26)</li>
                        <li>We are united with other believers (1 Corinthians 12:13)</li>
                    </ol>
                </div>
            </div>
        </div>
        
        <div class="topic" id="topic3">
            <div class="topic-completion" id="topic3Complete">✓</div>
            <h5>Topic 3: The Doctrine of Baptism</h5>
                       
            <div class="scripture">
                <p><strong>Matthew 28:19-20 (NKJV)</strong> - "Go therefore and make disciples of all the nations, baptizing them in the name of the Father and of the Son and of the Holy Spirit..."</p>
            </div>
            
            <div class="key-point">
                <h4>What Is Baptism?</h4>
                <p>Baptism is a <strong>public declaration</strong> of our faith in Jesus Christ. It's a sign of the new life we have in Jesus and our union with Him in His death, burial, and resurrection.</p>
                <p><em>Baptism is not what saves us, but it demonstrates that we are saved and part of God's family.</em></p>
            </div>
            
            <table class="baptism-table">
                <thead>
                    <tr>
                        <th>Aspect</th>
                        <th>Explanation</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Symbol</td>
                        <td>Represents dying to sin and rising to new life in Jesus</td>
                    </tr>
                    <tr>
                        <td>Not salvation</td>
                        <td>Baptism doesn't save us—only faith in Jesus does</td>
                    </tr>
                    <tr>
                    <tr>
                        <td>Command</td>
                        <td>Jesus commanded all believers to be baptized</td>
                    </tr>
                    <tr>
                        <td>Public declaration</td>
                        <td>Shows others you follow Jesus</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="collapsible">Why Be Baptized?</div>
            <div class="content">
                <h3>Why Should Every Believer Be Baptized?</h3>
                
                <div class="key-point">
                    <h4>1. To Follow Jesus' Example</h4>
                    <p><strong>Matthew 3:13-17</strong> - Jesus was baptized by John the Baptist</p>
                    <p>If Jesus thought baptism was important, we should too!</p>
                </div>
                
                <div class="key-point">
                    <h4>2. To Obey Jesus' Command</h4>
                    <p><strong>Matthew 28:19-20</strong> - Jesus told His followers to baptize new believers</p>
                    <p>Baptism is an act of obedience to Jesus.</p>
                </div>
                
                <div class="key-point">
                    <h4>3. To Show You're a Christian</h4>
                    <p><strong>Acts 2:41</strong> - Those who believed were baptized</p>
                    <p>Baptism publicly identifies you as a follower of Jesus.</p>
                </div>
                
                <div class="key-point">
                    <h4>4. To Picture the Gospel</h4>
                    <p><strong>Romans 6:3-4</strong> - Baptism pictures Jesus' death and resurrection</p>
                    <p>Going under water = dying with Jesus<br>
                    Coming up from water = rising to new life</p>
                </div>
            </div>
            
            <div class="collapsible">Baptism in the Early Church</div>
            <div class="content">
                <h3>Baptism in the Early Church</h3>
                
                <div class="key-point">
                    <h4>Immediate Obedience</h4>
                    <p>In the book of Acts, when people believed in Jesus, they were baptized right away:</p>
                    <ul>
                        <li><strong>Acts 2:41</strong> - 3,000 baptized on Pentecost</li>
                        <li><strong>Acts 8:12</strong> - Samaritans believed and were baptized</li>
                        <li><strong>Acts 8:36-38</strong> - Ethiopian eunuch baptized immediately</li>
                        <li><strong>Acts 16:14-15</strong> - Lydia and her household baptized</li>
                        <li><strong>Acts 16:31-33</strong> - Philippian jailer baptized same hour</li>
                    </ul>
                </div>
                
                <div class="key-point">
                    <h4>Key Pattern:</h4>
                    <p><strong>Hear the Gospel → Believe in Jesus → Be Baptized → Receive the Holy Spirit</strong></p>
                </div>
            </div>
            
            <div class="collapsible">Activity</div>
            <div class="content">
                <div class="activity">
                    <h4>Baptism Reflection</h4>
                    <p><strong>Have you been baptized since becoming a Christian?</strong></p>
                    <select style="width: 100%; padding: 10px; margin: 10px 0; border-radius: 6px;" data-topic="3" data-question="1">
                        <option value="">Select an option</option>
                        <option value="yes">Yes, I have been baptized</option>
                        <option value="no">No, I haven't been baptized yet</option>
                        <option value="unsure">I'm not sure</option>
                    </select>
                    
                    <p><strong>If you haven't been baptized, what's holding you back?</strong></p>
                    <textarea placeholder="Write your thoughts here..." style="width: 100%; min-height: 80px; margin-top: 10px;" data-topic="3" data-question="2"></textarea>
                    
                    <p><strong>Next Steps:</strong> Talk with your facilitator about being baptized if you haven't yet taken this important step of obedience.</p>
                </div>
            </div>
        </div>
        
        <div class="topic" id="topic4">
            <div class="topic-completion" id="topic4Complete">✓</div>
            <h5>Topic 4: The Doctrine of the Church (Ecclesiology)</h5>
            
            <div class="scripture">
                <p><strong>Ephesians 2:19-22 (NKJV)</strong> - "Now, therefore, you are no longer strangers and foreigners, but fellow citizens with the saints and members of the household of God..."</p>
            </div>
            
            <div class="key-point">
                <h4>What Is the Church?</h4>
                <p>The church is not a building—it's <strong>people</strong>. The Greek word for church is "ekklesia," which means "called-out ones" or "assembly." The church is all believers in Jesus Christ worldwide.</p>
            </div>
            
            <div class="collapsible">Biblical Images of the Church</div>
            <div class="content">
                <h3>Biblical Pictures of What the Church Is:</h3>
                
                <div class="identity-list">
                    <div class="identity-item">
                        <h4>1. The Body of Christ</h4>
                        <p><strong>1 Corinthians 12:27</strong> - "Now you are the body of Christ, and members individually."</p>
                        <p>Jesus is the head, and we are different parts working together.</p>
                    </div>
                    
                    <div class="identity-item">
                        <h4>2. The Family of God</h4>
                        <p><strong>Ephesians 2:19</strong> - "You are... members of the household of God."</p>
                        <p>We are God's children—brothers and sisters in Christ.</p>
                    </div>
                    
                    <div class="identity-item">
                        <h4>3. The Bride of Christ</h4>
                        <p><strong>Ephesians 5:25-27</strong> - "Christ also loved the church and gave Himself for her..."</p>
                        <p>Jesus loves and cares for the church as a groom loves his bride.</p>
                    </div>
                    
                    <div class="identity-item">
                        <h4>4. The Temple of the Holy Spirit</h4>
                        <p><strong>1 Corinthians 3:16</strong> - "Do you not know that you are the temple of God and that the Spirit of God dwells in you?"</p>
                        <p>Together, we form a spiritual temple where God lives by His Spirit.</p>
                    </div>
                    
                    <div class="identity-item">
                        <h4>5. The People of God</h4>
                        <p><strong>1 Peter 2:9-10</strong> - "You are a chosen generation, a royal priesthood, a holy nation, His own special people..."</p>
                        <p>We are God's special possession, called to show His goodness.</p>
                    </div>
                </div>
            </div>
            
            <div class="collapsible">Purpose of the Church</div>
            <div class="content">
                <h3>What Is the Church For?</h3>
                
                <div class="key-point">
                    <h4>The Five Purposes of the Church:</h4>
                    <ol>
                        <li><strong>Worship</strong> - Honoring God together (Ephesians 1:5-6)</li>
                        <li><strong>Fellowship</strong> - Caring for one another (Acts 2:42)</li>
                        <li><strong>Discipleship</strong> - Growing to be like Jesus (Matthew 28:19-20)</li>
                        <li><strong>Ministry</strong> - Serving others (Ephesians 4:11-12)</li>
                        <li><strong>Mission</strong> - Sharing the gospel (Acts 1:8)</li>
                    </ol>
                </div>
                
                <div class="key-point">
                    <h4>The Church's Mission:</h4>
                    <p><strong>Matthew 28:19-20</strong> - "Go therefore and make disciples of all the nations..."</p>
                    <p><strong>Acts 1:8</strong> - "You shall be witnesses to Me in Jerusalem, and in all Judea and Samaria, and to the end of the earth."</p>
                </div>
            </div>
            
            <div class="collapsible">Activity</div>
            <div class="content">
                <div class="activity">
                    <h4>Church Involvement Assessment</h4>
                    <p>Rate your current involvement in each purpose of the church (1 = rarely, 5 = regularly):</p>
                    
                    <div style="margin: 15px 0;">
                        <p><strong>Worship</strong> - Gathering with believers to honor God</p>
                        <select style="width: 100%; padding: 8px; margin: 5px 0;" data-topic="4" data-question="1">
                            <option value="">Select rating</option>
                            <option value="1">1 - Rarely</option>
                            <option value="2">2 - Occasionally</option>
                            <option value="3">3 - Sometimes</option>
                            <option value="4">4 - Often</option>
                            <option value="5">5 - Regularly</option>
                        </select>
                    </div>
                    
                    <div style="margin: 15px 0;">
                        <p><strong>Fellowship</strong> - Building relationships with other believers</p>
                        <select style="width: 100%; padding: 8px; margin: 5px 0;" data-topic="4" data-question="2">
                            <option value="">Select rating</option>
                            <option value="1">1 - Rarely</option>
                            <option value="2">2 - Occasionally</option>
                            <option value="3">3 - Sometimes</option>
                            <option value="4">4 - Often</option>
                            <option value="5">5 - Regularly</option>
                        </select>
                    </div>
                    
                    <div style="margin: 15px 0;">
                        <p><strong>Discipleship</strong> - Growing in your relationship with Jesus</p>
                        <select style="width: 100%; padding: 8px; margin: 5px 0;" data-topic="4" data-question="3">
                            <option value="">Select rating</option>
                            <option value="1">1 - Rarely</option>
                            <option value="2">2 - Occasionally</option>
                            <option value="3">3 - Sometimes</option>
                            <option value="4">4 - Often</option>
                            <option value="5">5 - Regularly</option>
                        </select>
                    </div>
                    
                    <div style="margin: 15px 0;">
                        <p><strong>Ministry</strong> - Using your gifts to serve others</p>
                        <select style="width: 100%; padding: 8px; margin: 5px 0;" data-topic="4" data-question="4">
                            <option value="">Select rating</option>
                            <option value="1">1 - Rarely</option>
                            <option value="2">2 - Occasionally</option>
                            <option value="3">3 - Sometimes</option>
                            <option value="4">4 - Often</option>
                            <option value="5">5 - Regularly</option>
                        </select>
                    </div>
                    
                    <div style="margin: 15px 0;">
                        <p><strong>Mission</strong> - Sharing your faith with others</p>
                        <select style="width: 100%; padding: 8px; margin: 5px 0;" data-topic="4" data-question="5">
                            <option value="">Select rating</option>
                            <option value="1">1 - Rarely</option>
                            <option value="2">2 - Occasionally</option>
                            <option value="3">3 - Sometimes</option>
                            <option value="4">4 - Often</option>
                            <option value="5">5 - Regularly</option>
                        </select>
                    </div>
                    
                    <p><strong>Which area do you want to grow in most?</strong></p>
                    <textarea placeholder="Write your response here..." style="width: 100%; min-height: 60px; margin-top: 10px;" data-topic="4" data-question="6"></textarea>
                </div>
            </div>
        </div>
        
        <div class="lesson-nav">
            <a href="module-lesson3.html" class="btn">Previous Lesson</a>
            <a href=../progress.html" class="btn">Dashboard</a>
           
            <a href="module-lesson5.html" class="btn">Next Lesson</a>
        </div>
    </div>
    
    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="btn btn-outline" id="logoutBtn">LogOut</button>
        <a href="../progress.html" class="nav-item">
            <i class="bi bi-graph-up"></i>
            <span>Progress</span>
        </a>
        <a href="resources.html" class="nav-item">
            <i class="bi bi-journal-text"></i>
            <span>Resources</span>
        </a>
        <a href="settings.html" class="nav-item">
            <i class="bi bi-gear"></i>
            <span>Settings</span>
        </a>
    </div>
    
    <!-- Sync Status -->
    <div class="sync-status" id="syncStatus">Checking connection...</div>
    
    <!-- Manual Sync Button -->
    <button id="manualSync" title="Sync Progress">
        <i class="bi bi-arrow-repeat"></i>
    </button>
    
    <!-- Save Notification -->
    <div class="save-notification" id="saveNotification">
        <i class="bi bi-check-circle"></i> Progress saved
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
 <script>
// ==================== ONLINE SAVING ENHANCEMENT ====================
// This module adds cloud saving without changing original functionality
// All original code remains completely unchanged below
const OnlineSaver = (function() {
    let initialized = false;
    
    const CloudService = {
        isAuthenticated: false,
        userEmail: null,
        
        init() {
            this.checkAuthStatus();
            this.setupCloudEnhancements();
            console.log('OnlineSaver: Cloud service initialized');
        },
        
        checkAuthStatus() {
            this.isAuthenticated = localStorage.getItem("isLoggedIn") === "true";
            this.userEmail = localStorage.getItem("userEmail");
        },
        
        setupCloudEnhancements() {
            this.enhanceSaveProgress();
            this.enhanceManualSync();
            this.enhanceSyncStatus();
        },
        
        enhanceSaveProgress() {
            const originalSaveProgress = window.saveProgress;
            
            window.saveProgress = function() {
                // Call original function first
                if (originalSaveProgress) {
                    originalSaveProgress();
                }
                
                // Then save to cloud
                CloudService.saveToCloud();
            };
        },
        
        enhanceManualSync() {
            const manualSyncBtn = document.getElementById('manualSync');
            if (manualSyncBtn) {
                const originalHandler = manualSyncBtn.onclick;
                
                manualSyncBtn.onclick = function(e) {
                    // Call original handler
                    if (originalHandler) originalHandler(e);
                    
                    // Add cloud sync
                    if (CloudService.isAuthenticated) {
                        CloudService.forceCloudSync();
                    }
                };
            }
        },
        
        enhanceSyncStatus() {
            const originalUpdateSyncStatus = window.updateSyncStatus;
            
            window.updateSyncStatus = function() {
                // Call original function
                if (originalUpdateSyncStatus) originalUpdateSyncStatus();
                
                // Enhance with cloud info
                CloudService.updateCloudIndicator();
            };
        },
        
        saveToCloud() {
            if (!this.isAuthenticated) return;
            
            console.log('OnlineSaver: Saving to cloud...');
            
            // Collect all current data
            const lessonData = this.collectLessonData();
            const progressData = this.collectProgressData();
            
            const cloudPayload = {
                ...lessonData,
                ...progressData,
                timestamp: new Date().toISOString(),
                user: this.userEmail,
                lesson: 'current'
            };
            
            // Simulate cloud API call
            setTimeout(() => {
                // Store in localStorage as cloud simulation
                localStorage.setItem(`cloud_${this.userEmail}_backup`, JSON.stringify(cloudPayload));
                
                // Update UI feedback
                this.showCloudSaveIndicator();
                
                console.log('OnlineSaver: Cloud save completed');
            }, 600);
        },
        
        collectLessonData() {
            const data = {};
            const inputs = document.querySelectorAll('textarea, select, input[type="text"]');
            
            inputs.forEach(input => {
                const topicId = input.closest('.topic')?.id;
                if (topicId) {
                    if (!data[topicId]) data[topicId] = {};
                    data[topicId][input.name || `field_${Date.now()}`] = input.value;
                }
            });
            
            return { formData: data };
        },
        
        collectProgressData() {
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            return {
                progress: {
                    percentage: progressBar ? progressBar.style.width : '0%',
                    text: progressText ? progressText.textContent : '0%',
                    timestamp: new Date().toISOString()
                }
            };
        },
        
        forceCloudSync() {
            if (!this.isAuthenticated) return;
            
            console.log('OnlineSaver: Force syncing to cloud...');
            
            // Enhance the sync status during cloud operation
            const syncStatus = document.getElementById('syncStatus');
            if (syncStatus) {
                const originalText = syncStatus.textContent;
                syncStatus.textContent = 'Syncing to Cloud...';
                
                setTimeout(() => {
                    syncStatus.textContent = originalText;
                }, 2000);
            }
            
            this.saveToCloud();
        },
        
        updateCloudIndicator() {
            if (!this.isAuthenticated) return;
            
            const syncStatus = document.getElementById('syncStatus');
            if (!syncStatus) return;
            
            // Add cloud indicator to status
            if (syncStatus.textContent.includes('Online') && !syncStatus.textContent.includes('Cloud')) {
                syncStatus.textContent = 'Online - Cloud Ready';
            }
        },
        
        showCloudSaveIndicator() {
            // Create a subtle cloud save indicator
            const existingIndicator = document.querySelector('.cloud-save-indicator');
            if (existingIndicator) {
                existingIndicator.remove();
            }
            
            const indicator = document.createElement('div');
            indicator.className = 'cloud-save-indicator';
            indicator.innerHTML = '✓ Cloud';
            indicator.style.cssText = `
                position: absolute;
                top: -8px;
                right: -8px;
                background: #4CAF50;
                color: white;
                border-radius: 10px;
                padding: 2px 6px;
                font-size: 0.6rem;
                font-weight: bold;
                z-index: 1001;
            `;
            
            const notification = document.getElementById('saveNotification');
            if (notification) {
                notification.style.position = 'relative';
                notification.appendChild(indicator);
                
                setTimeout(() => {
                    if (indicator.parentNode) {
                        indicator.remove();
                    }
                }, 2000);
            }
        },
        
        checkCloudBackup() {
            if (!this.isAuthenticated) return;
            
            const cloudData = localStorage.getItem(`cloud_${this.userEmail}_backup`);
            if (cloudData) {
                console.log('OnlineSaver: Cloud backup available');
                this.showCloudBackupAvailable();
            }
        },
        
        showCloudBackupAvailable() {
            const backupIndicator = document.createElement('div');
            backupIndicator.className = 'cloud-backup-indicator';
            backupIndicator.innerHTML = '🔄 Cloud backup available';
            backupIndicator.style.cssText = `
                position: fixed;
                bottom: 80px;
                right: 20px;
                background: #2196F3;
                color: white;
                padding: 8px 12px;
                border-radius: 20px;
                font-size: 0.8rem;
                z-index: 999;
                animation: pulse 2s infinite;
            `;
            
            document.body.appendChild(backupIndicator);
            
            setTimeout(() => {
                if (backupIndicator.parentNode) {
                    backupIndicator.remove();
                }
            }, 5000);
        }
    };

    return {
        init() {
            if (initialized) return;
            
            // Initialize cloud service
            CloudService.init();
            
            // Check for existing cloud backups
            setTimeout(() => CloudService.checkCloudBackup(), 2000);
            
            // Set up auth state monitoring
            this.monitorAuthState();
            
            initialized = true;
            console.log('OnlineSaver: Online saving enabled');
        },
        
        monitorAuthState() {
            // Check auth status periodically
            setInterval(() => {
                const wasAuthenticated = CloudService.isAuthenticated;
                CloudService.checkAuthStatus();
                
                if (!wasAuthenticated && CloudService.isAuthenticated) {
                    console.log('OnlineSaver: User logged in, enabling cloud features');
                    CloudService.checkCloudBackup();
                } else if (wasAuthenticated && !CloudService.isAuthenticated) {
                    console.log('OnlineSaver: User logged out, cloud features disabled');
                }
            }, 5000);
        }
    };
})();

// Initialize online saving when DOM loads
document.addEventListener('DOMContentLoaded', function() {
    OnlineSaver.init();
});
// ==================== END ONLINE SAVING ENHANCEMENT ====================

// ==================== ORIGINAL CODE - COMPLETELY UNCHANGED ====================
        // Collapsible functionality
        document.addEventListener('DOMContentLoaded', function() {
            const collapsibles = document.querySelectorAll('.collapsible');
            
            collapsibles.forEach(button => {
                button.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const content = this.nextElementSibling;
                    
                    if (content.classList.contains('open')) {
                        content.classList.remove('open');
                        // Reset max-height after transition completes
                        setTimeout(() => {
                            content.style.maxHeight = null;
                        }, 300);
                    } else {
                        content.classList.add('open');
                        content.style.maxHeight = content.scrollHeight + 'px';
                    }
                });
            });
            
            // Initialize first section as open
            if (collapsibles.length > 0) {
                collapsibles[0].classList.add('active');
                const firstContent = collapsibles[0].nextElementSibling;
                firstContent.classList.add('open');
                firstContent.style.maxHeight = firstContent.scrollHeight + 'px';
            }
            
            // Progress tracking
            updateProgress();
            
            // Form field auto-save
            setupAutoSave();
            
            // Sync status
            updateSyncStatus();
        });
        
        // Progress tracking functionality
        function updateProgress() {
            const totalTopics = 4;
            let completedTopics = 0;
            
            // Check which topics have responses
            for (let i = 1; i <= totalTopics; i++) {
                const topicElement = document.getElementById(`topic${i}`);
                const inputs = topicElement.querySelectorAll('textarea, select, input[type="text"]');
                let hasResponse = false;
                
                inputs.forEach(input => {
                    if (input.value.trim() !== '') {
                        hasResponse = true;
                    }
                });
                
                if (hasResponse) {
                    completedTopics++;
                    document.getElementById(`topic${i}Complete`).classList.add('visible');
                } else {
                    document.getElementById(`topic${i}Complete`).classList.remove('visible');
                }
            }
            
            const progressPercent = Math.round((completedTopics / totalTopics) * 100);
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            progressBar.style.width = `${progressPercent}%`;
            progressBar.textContent = `${progressPercent}%`;
            progressText.textContent = `${progressPercent}%`;
            
            // Update last saved time
            document.getElementById('lastSaved').textContent = new Date().toLocaleTimeString();
            
            return progressPercent;
        }
        
        // Auto-save functionality
        function setupAutoSave() {
            const inputs = document.querySelectorAll('textarea, select, input[type="text"]');
            let saveTimeout;
            
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    clearTimeout(saveTimeout);
                    saveTimeout = setTimeout(() => {
                        saveProgress();
                        updateProgress();
                    }, 1000);
                });
                
                input.addEventListener('change', function() {
                    saveProgress();
                    updateProgress();
                });
            });
        }
        
        function saveProgress() {
            // Show save notification
            const notification = document.getElementById('saveNotification');
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000);
            
            // In a real app, this would save to localStorage or a database
            console.log('Progress saved at:', new Date().toLocaleString());
        }
        
        // Sync status functionality
        function updateSyncStatus() {
            const syncStatus = document.getElementById('syncStatus');
            
            // Simulate checking connection
            setTimeout(() => {
                if (navigator.onLine) {
                    syncStatus.textContent = 'Synced';
                    syncStatus.className = 'sync-status online';
                } else {
                    syncStatus.textContent = 'Offline - Changes saved locally';
                    syncStatus.className = 'sync-status offline';
                }
            }, 1000);
        }
        
        // Manual sync functionality
        document.getElementById('manualSync').addEventListener('click', function() {
            const syncStatus = document.getElementById('syncStatus');
            syncStatus.textContent = 'Syncing...';
            syncStatus.className = 'sync-status syncing';
            
            // Simulate sync process
            setTimeout(() => {
                syncStatus.textContent = 'Online - Synced';
                syncStatus.className = 'sync-status online';
                
                // Show confirmation
                const notification = document.getElementById('saveNotification');
                notification.innerHTML = '<i class="bi bi-cloud-check"></i> Synced to cloud';
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 2000);
            }, 1500);
        });
        
        // Online/offline detection
        window.addEventListener('online', updateSyncStatus);
        window.addEventListener('offline', updateSyncStatus);
// ==================== END ORIGINAL CODE ====================
</script>

<!-- Additional CSS for cloud features (non-invasive) -->
<style>
    /* Cloud enhancement styles - doesn't affect original design */
    .cloud-save-indicator {
        animation: bounce 0.5s ease-in-out;
    }
    
    .cloud-backup-indicator {
        box-shadow: 0 2px 10px rgba(33, 150, 243, 0.3);
    }
    
    @keyframes bounce {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
    }
    
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
    }
    
    /* Enhanced sync status for cloud */
    .sync-status.online::after {
        content: " ☁️";
        font-size: 0.8em;
    }
</style>

<script>
// Logout functionality - ORIGINAL CODE UNCHANGED
   // Logout functionality
            logoutBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to logout?')) {
                    // In a real app, this would clear authentication tokens
                    // and redirect to login page
                    showNotification('You have been logged out successfully.', 'success');
                    setTimeout(() => {
                        // Simulate logout - in a real app, redirect to login
                        window.location.href = '../index.html';
                    }, 1500);
                }
            });
</script>

<script type="module" src="../auth-check.js"></script>
</body>
</html>