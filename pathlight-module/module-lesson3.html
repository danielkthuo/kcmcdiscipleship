<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 3: Lordship - Pathlight Curriculum</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
     <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#2c3e50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="KCM Church">
    <meta name="description" content="Discipleship Tool for Kingdom Covenant Ministries Church">
    <meta name="keywords" content="church, discipleship, christian, ministry">
    <meta name="author" content="Kingdom Covenant Ministries Church">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="icons/icon-152x152.png">
    <link rel="apple-touch-startup-image" href="icons/icon-512x512.png">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Viewport for mobile optimization -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <!-- Preload important resources -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com/ajax.googleapis.com">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --success-color: #2ecc71;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-main);
            line-height: 1.6;
            color: #333;
            background-color: #f9f9f9;
            padding-bottom: 80px; /* Space for bottom nav */
            -webkit-text-size-adjust: 100%; /* Prevent font scaling in landscape */
        }
        
        .container {
            width: 100%;
            margin: 0 auto;
            padding: 15px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1.5rem 0;
            text-align: center;
            margin-bottom: 1.5rem;
            position: relative;
            width: 100%;
        }
        
        .header-content {
            width: 100%;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }
        
        .lesson-nav {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            display: inline-block;
            background-color: var(--secondary-color);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            text-align: center;
            flex: 1;
            min-height: 48px; /* Minimum touch target size */
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 120px;
        }
        
        .btn:hover {
            background-color: var(--primary-color);
        }
        
        .topic {
            background-color: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: relative;
            width: 100%;
        }
        
        .topic h2 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.5rem;
            font-size: 1.4rem;
        }
        
        .scripture {
            background-color: #f8f9fa;
            border-left: 4px solid var(--secondary-color);
            padding: 1rem;
            margin: 1rem 0;
            font-style: italic;
            border-radius: 0 8px 8px 0;
        }
        
        .key-point {
            background-color: #e8f4fc;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .key-point h4 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        
        .activity {
            background-color: #fff8e1;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }
        
        .activity h4 {
            color: #e65100;
            margin-bottom: 0.5rem;
        }
        
        .worksheet {
            background-color: #e8f5e9;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid #4caf50;
        }
        
        .worksheet h4 {
            color: #2e7d32;
            margin-bottom: 1rem;
        }
        
        .room-metaphor {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid #9c27b0;
        }
        
        .room-metaphor h4 {
            color: #7b1fa2;
            margin-bottom: 1rem;
        }
        
        .stoplight {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }
        
        .stoplight-light {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            margin: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .stoplight-green {
            background-color: #4caf50;
        }
        
        .stoplight-yellow {
            background-color: #ffc107;
        }
        
        .stoplight-red {
            background-color: #f44336;
        }
        
        .backpack-visual {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
        }
        
        .backpack-item {
            flex: 1;
            min-width: 150px;
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .backpack-item.negative {
            border-left: 4px solid #f44336;
        }
        
        .backpack-item.positive {
            border-left: 4px solid #4caf50;
        }
        
        .heart-house {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }
        
        .heart-house-image {
            width: 250px;
            height: 250px;
            background-color: #ffebee;
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .heart-door {
            width: 70px;
            height: 100px;
            background-color: #e74c3c;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .room-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        
        .room-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            width: 100%;
        }
        
        footer {
            text-align: center;
            margin-top: 3rem;
            padding: 1.5rem;
            background-color: var(--dark-color);
            color: white;
            border-radius: 12px;
            width: 100%;
        }
        
        /* Progress Bar Styles */
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .progress-bar {
            height: 20px;
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
            width: 0%;
            border-radius: 10px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 14px;
            color: #666;
        }
        
        /* Auto-save notification */
        .save-notification {
            position: fixed;
            bottom: 70px;
            right: 15px;
            background-color: var(--success-color);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
            font-size: 0.9rem;
        }
        
        .save-notification.show {
            opacity: 1;
        }
        
        /* Topic completion indicator - FIXED */
        .topic-completion {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            border: 2px solid #ccc;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .topic-completion.completed {
            background: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }
        
        .topic-completion.completed::after {
            content: "✓";
            font-weight: bold;
        }
        
        /* Collapsible sections with scrollable content */
        .collapsible {
            background-color: #f1f1f1;
            color: var(--primary-color);
            cursor: pointer;
            padding: 14px 18px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1rem;
            font-weight: 500;
            border-radius: 8px;
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
            min-height: 48px; /* Minimum touch target size */
        }
        
        .collapsible:hover {
            background-color: #e8f4fc;
        }
        
        .collapsible::after {
            content: '+';
            font-weight: bold;
            font-size: 1.1rem;
            transition: transform 0.3s;
            color: var(--primary-color);
        }
        
        .collapsible.active::after {
            content: '–';
            transform: rotate(180deg);
        }
        
        .content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: #ffffff;
            border-radius: 0 0 8px 8px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
            padding: 0 16px;
        }
        
        .content.open {
            max-height: 400px; /* Set a maximum height for scrollable sections */
            overflow-y: auto; /* Enable vertical scrolling */
            padding: 15px;
            border: 1px solid #e1e1e1;
            border-top: none;
        }
        
        /* Custom scrollbar for content */
        .content.open::-webkit-scrollbar {
            width: 8px;
        }
        
        .content.open::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .content.open::-webkit-scrollbar-thumb {
            background: var(--secondary-color);
            border-radius: 4px;
        }
        
        .content.open::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }
        
        /* Form field styling */
        textarea, input[type="text"] {
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-family: var(--font-main);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            width: 100%;
            font-size: 16px; /* Prevent zoom on iOS */
        }
        
        textarea:focus, input[type="text"]:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: white;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #666;
            font-size: 0.8rem;
            padding: 5px 10px;
            border-radius: 5px;
            transition: all 0.3s ease;
            min-height: 48px; /* Minimum touch target size */
            justify-content: center;
        }
        
        .nav-item.active {
            color: var(--secondary-color);
            background-color: #e8f4fc;
        }
        
        .nav-icon {
            font-size: 1.2rem;
            margin-bottom: 3px;
        }
        
        /* Sync status styles */
         .sync-status {
                        position: fixed;
                        top: 10px;
                        right: 10px;
                        background: rgba(255,255,255,0.9);
                        padding: 5px 10px;
                        border-radius: 20px;
                        font-size: 0.8rem;
                        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                        z-index: 1000;
                        display: flex;
                        align-items: center;
                        gap: 5px;
                        transition: all 0.3s ease;
                    }
                    .sync-status.offline {
                        color: #f39c12;
                    }
                    .sync-status.online {
                        color: #2ecc71;
                    }
                    .sync-status.error {
                        color: #e74c3c;
                    }
                    @media (max-width: 768px) {
                        .sync-status {
                            top: 5px;
                            right: 5px;
                            font-size: 0.75rem;
                            padding: 4px 8px;
                        }
                    }
                
        
        /* Manual sync button */
        #manualSync {
            position: fixed;
            bottom: 70px;
            right: 15px;
            background: var(--secondary-color, #3498db);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            font-size: 1.2rem;
        }
        
        /* Mobile-specific improvements */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header {
                padding: 1rem 0;
                margin-bottom: 1rem;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .topic {
                padding: 1rem;
                margin-bottom: 1rem;
            }
            
            .topic h2 {
                font-size: 1.2rem;
            }
            
            .btn {
                padding: 14px 16px;
                font-size: 0.9rem;
                min-width: 100px;
            }
            
            .heart-house-image {
                width: 200px;
                height: 200px;
            }
            
            .heart-door {
                width: 60px;
                height: 80px;
            }
            
            .stoplight-light {
                width: 60px;
                height: 60px;
            }
            
            .backpack-visual {
                flex-direction: column;
            }
            
            .save-notification {
                bottom: 60px;
                right: 10px;
                left: 10px;
                text-align: center;
            }
            
            /* Adjust scrollable content height for mobile */
            .content.open {
                max-height: 300px;
            }
            
            .sync-status {
                top: 5px;
                right: 5px;
                left: 5px;
                max-width: none;
                text-align: center;
            }
            
            .progress-info {
                flex-direction: column;
                gap: 5px;
            }
            
            .lesson-nav {
                gap: 8px;
            }
        }
        
        @media (min-width: 769px) {
            .container {
                max-width: 100%;
            }
            
            .backpack-visual, .room-list {
                flex-direction: row;
            }
            
            /* Adjust scrollable content height for larger screens */
            .content.open {
                max-height: 500px;
            }
        }
        
        /* Prevent horizontal scrolling */
        html, body {
            max-width: 100%;
            overflow-x: hidden;
        }
        
        /* Improve touch interactions */
        button, .btn, .nav-item, .topic-completion {
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        /* Improve text readability on mobile */
        p, li, td, th {
            font-size: 16px;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <br>
            <h1>Lesson 3: Lordship</h1>
            <p>Making Jesus Lord of your life and understanding the cost of discipleship</p>
        </div>
    </header>
    
    <div class="container">
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>
        <div class="progress-info">
            <span>Progress: <span id="progressText">0%</span></span>
            <span>Last saved: <span id="lastSaved">Not saved yet</span></span>
        </div>
        
        <div class="lesson-nav">
            <a href="module-lesson2.html" class="btn">Previous Lesson</a>
            <a href="../progress.html" class="btn">Dashboard</a>
            <a href="module-lesson4.html" class="btn">Next Lesson</a>
        </div>
        
        <div class="topic" id="topic1">
            <div class="topic-completion" id="topic1Complete" data-topic="1"></div>
            <h2>Topic 1: Cost of Discipleship</h2>
            
            <div class="scripture">
                <p><strong>Romans 10:9 (NIV)</strong> - "If you declare with your mouth, 'Jesus is Lord,' and believe in your heart that God raised him from the dead, you will be saved."</p>
            </div>
            
            <p><strong>"Lord"</strong> means <em>Master, Leader, or One in charge</em>. Saying "Jesus is Lord" means "Jesus is in control of my life—He commands/leads, and I obey/follow."</p>
            
            <div class="scripture">
                <p><strong>Luke 14:25-33 (NKJV)</strong> - "Now great multitudes went with Him. And He turned and said to them, 'If anyone comes to Me and does not hate his father and mother, wife and children, brothers and sisters, yes, and his own life also, he cannot be My disciple. And whoever does not bear his cross and come after Me cannot be My disciple.'"</p>
            </div>
            
            <div class="collapsible">Introduction</div>
            <div class="content">
                <h3>1. Introduce the Concept: What Is Discipleship?</h3>
                <p>Begin by asking learners: "What does it mean to follow someone (e.g., in social media)?"</p>
                <p>Then guide: To follow Jesus means we obey His teaching, live like Him, and trust Him even when it's hard. That's called discipleship.</p>
                
                <h3>2. Explain the "Cost" Part (Luke 14:27-33)</h3>
                <p>Jesus said if we want to follow Him, we must carry our cross. That means we must be ready to give up things for His sake.</p>
                
                <div class="key-point">
                    <h4>Practical Examples of Cost:</h4>
                    <ul>
                        <li>A child might choose truth over cheating</li>
                        <li>A teen might face peer pressure but choose obedience</li>
                        <li>An adult might let go of career ambition to follow God's calling</li>
                        <li>Choosing kindness over revenge</li>
                        <li>Saying no to cheating even if it means a lower grade</li>
                    </ul>
                </div>
                
                <div class="key-point">
                    <h4>Jesus' Parables About Counting Cost:</h4>
                    <p><strong>The Builder (Luke 14:28-30)</strong> - Doesn't start building without calculating if he can finish</p>
                    <p><strong>The King (Luke 14:31-32)</strong> - Considers if he can win before going to war</p>
                    <p><em>"Jesus wants us to think before we follow Him—to know it will take commitment."</em></p>
                </div>
            </div>
            
            <div class="collapsible">Requirements</div>
            <div class="content">
                <h3>3. Following Jesus Requires:</h3>
                <ul>
                    <li>Saying Yes to Him even when friends say no</li>
                    <li>Letting go of selfishness or sin</li>
                    <li>Obeying Him daily, even when it's not popular</li>
                </ul>
                
                <h3>4. Encourage Realistic Commitment</h3>
                <p>Jesus isn't looking for fans but followers. Discipleship isn't always easy, but Jesus gives strength, peace, joy, and eternal life.</p>
                <div class="scripture">
                    <p><strong>Hebrews 13:5</strong> - "I will never leave you or forsake you."</p>
                </div>
            </div>
            
            <div class="collapsible">Teaching Tips</div>
            <div class="content">
                <div class="activity">
                    <h4>Teaching Tip: Backpack Visual</h4>
                    <p>Bring a backpack with labeled objects: fear, pride, sin, comfort, selfishness. Take them out one by one as learners discuss what they need to surrender to follow Christ. Replace with faith, obedience, love, sacrifice, joy.</p>
                    
                    <div class="backpack-visual">
                        <div class="backpack-item negative">
                            <h5>Fear</h5>
                            <p>Replace with Faith</p>
                        </div>
                        <div class="backpack-item negative">
                            <h5>Pride</h5>
                            <p>Replace with Humility</p>
                        </div>
                        <div class="backpack-item negative">
                            <h5>Sin</h5>
                            <p>Replace with Obedience</p>
                        </div>
                        <div class="backpack-item negative">
                            <h5>Comfort</h5>
                            <p>Replace with Sacrifice</p>
                        </div>
                        <div class="backpack-item negative">
                            <h5>Selfishness</h5>
                            <p>Replace with Love</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="collapsible">Worksheet</div>
            <div class="content">
                <div class="worksheet">
                    <h4>Worksheet: The Cost of Following Jesus</h4>
                    <p><strong>Memory Verse:</strong> Luke 14:27-28 (NKJV) - "And whoever does not bear his cross and come after Me cannot be My disciple. For which of you, intending to build a tower, does not sit down first and count the cost, whether he has enough to finish it-"</p>
                    
                    <div class="key-point">
                        <h4>What It Means to Be a Disciple</h4>
                        <p><em>In your own words, what does it mean to be a disciple of Jesus?</em></p>
                        <textarea placeholder="Write your response here..." style="width: 100%; min-height: 80px; margin-top: 10px;" data-topic="1" data-question="1"></textarea>
                    </div>
                    
                    <div class="key-point">
                        <h4>Counting the Cost</h4>
                        <p>Following Jesus may cost you something—comfort, popularity, time, pride, or personal plans—but it leads to eternal life, true peace, and purpose.</p>
                        
                        <p><strong>List 2 things that might cost you something if you fully follow Jesus:</strong></p>
                        <p>1. <input type="text" style="width: 100%; margin: 5px 0;" data-topic="1" data-question="2a"></p>
                        <p>2. <input type="text" style="width: 100%; margin: 5px 0;" data-topic="1" data-question="2b"></p>
                        
                        <p><strong>List 2 blessings that come from following Him:</strong></p>
                        <p>1. <input type="text" style="width: 100%; margin: 5px 0;" data-topic="1" data-question="3a"></p>
                        <p>2. <input type="text" style="width: 100%; margin: 5px 0;" data-topic="1" data-question="3b"></p>
                    </div>
                </div>
            </div>
            
            <div class="collapsible">Reflection</div>
            <div class="content">
                <div class="key-point">
                    <h4>Learner Reflection Questions:</h4>
                    <p>1. What is one thing Jesus may be asking you to surrender today?</p>
                    <textarea placeholder="Write your response here..." style="width: 100%; min-height: 60px; margin-top: 10px;" data-topic="1" data-question="4"></textarea>
                    
                    <p>2. Why do you think Jesus asks us to "count the cost" before following Him?</p>
                    <textarea placeholder="Write your response here..." style="width: 100%; min-height: 60px; margin-top: 10px;" data-topic="1" data-question="5"></textarea>
                </div>
                
                <div class="key-point">
                    <h4>Challenge of the Week:</h4>
                    <p>This week, do one thing that shows you are serious about following Jesus, even when it costs you something.</p>
                    <p>Describe it here:</p>
                    <textarea placeholder="Describe your challenge..." style="width: 100%; min-height: 60px; margin-top: 10px;" data-topic="1" data-question="6"></textarea>
                </div>
            </div>
        </div>
        
        <div class="topic" id="topic2">
            <div class="topic-completion" id="topic2Complete" data-topic="2"></div>
            <h2>Topic 2: Submission - Areas of Struggle</h2>
            
            <div class="scripture">
                <p><strong>James 4:7 (NKJV)</strong> - "Therefore submit to God. Resist the devil and he will flee from you."</p>
            </div>
            
            <div class="key-point">
                <h4>Definition:</h4>
                <p>Submission is choosing to <strong>obey God's authority</strong> and those He has placed over us—willingly, not forcefully. It's about <strong>trusting God's way</strong> even when we want our own way.</p>
                <p><em>It's not weakness but a strength of the heart that chooses obedience over rebellion.</em></p>
            </div>
            
            <div class="key-point">
                <h4>Jesus' Example</h4>
                <p><strong>Philippians 2:8</strong> - "He humbled Himself and became obedient to the point of death, even the death of the cross."</p>
                <p>Jesus Himself submitted to the Father's will.</p>
            </div>
            
            <div class="collapsible">Areas of Struggle</div>
            <div class="content">
                <h3>Common Areas of Struggle in Submission:</h3>
                
                <div class="key-point">
                    <h4>1. To God's Word</h4>
                    <p><strong>Struggle:</strong> Putting off things that seem hard (forgiveness, purity, tithing)</p>
                    <p><strong>Response:</strong> Obey the Word even when uncomfortable</p>
                </div>
                
                <div class="key-point">
                    <h4>2. To Parents/Guardians</h4>
                    <p><strong>Struggle:</strong> Wanting independence and control too soon</p>
                    <p><strong>Response:</strong> Trust they are directing you for your best</p>
                </div>
                
                <div class="key-point">
                    <h4>3. To Church or Spiritual Leaders</h4>
                    <p><strong>Struggle:</strong> Disagreeing with decisions or correction</p>
                    <p><strong>Response:</strong> Honor the instruction of the faith community (<strong>Hebrews 13:17</strong>)</p>
                </div>
                
                <div class="key-point">
                    <h4>4. To Government/Authority Figures</h4>
                    <p><strong>Struggle:</strong> Injustice or unfair rules</p>
                    <p><strong>Response:</strong> Obey laws unless they contradict God's Word (<strong>Romans 13:1-2</strong>)</p>
                </div>
                
                <div class="key-point">
                    <h4>5. To One Another (Mutual Submission)</h4>
                    <p><strong>Struggle:</strong> Pride, wanting to always be right or go first</p>
                    <p><strong>Response:</strong> Put others before yourself (<strong>Philippians 2:3-4</strong>)</p>
                </div>
            </div>
            
            <div class="collapsible">Activity</div>
            <div class="content">
                <div class="activity">
                    <h4>Activity: Submission Stoplight</h4>
                    <div class="stoplight">
                        <div class="stoplight-light stoplight-green">
                            <small>GREEN<br>Obey Right Away </small>
                        </div>
                        <div class="stoplight-light stoplight-yellow">
                            <small>YELLOW<br>Ask for Help</small>
                        </div>
                        <div class="stoplight-light stoplight-red">
                            <small>RED<br>Disobey or Delay</small>
                        </div>
                    </div>
                    
                    <p><strong>Green - Obey Right Away (Submission)</strong></p>
                    <p>Examples: Doing chores without complaining, forgiving quickly, saying yes to God even when it's hard.</p>
                    <p>Green choices lead to peace, blessings, and growth.</p>
                    
                    <p><strong>Yellow - Ask for Help or Pray First</strong></p>
                    <p>Examples: When we feel tempted, confused about a command, or emotionally overwhelmed.</p>
                    <p>Prayer is a way of submitting in weakness and asking for God's strength.</p>
                    
                    <p><strong>Red - Disobey or Delay Obedience</strong></p>
                    <p>Examples: Ignoring God's Word, arguing with authority, choosing sin knowingly.</p>
                    <p>Consequences: broken trust, guilt, missed blessings, hurt relationships.</p>
                </div>
            </div>
            
            <div class="collapsible">Worksheet</div>
            <div class="content">
                <div class="worksheet">
                    <h4>Worksheet: Submission - Areas of Struggle</h4>
                    <p><strong>James 4:7 (NIV)</strong> - "Submit yourselves, then, to God. Resist the devil, and he will flee from you."</p>
                    
                    <div class="key-point">
                        <h4>Learner Reflection Questions:</h4>
                        <p>1. Which areas do I struggle to submit, and why?</p>
                        <textarea placeholder="Write your response here..." style="width: 100%; min-height: 80px; margin-top: 10px;" data-topic="2" data-question="1"></textarea>
                        
                        <p>2. How can trusting God help me submit with the right heart?</p>
                        <textarea placeholder="Write your response here..." style="width: 100%; min-height: 80px; margin-top: 10px;" data-topic="2" data-question="2"></textarea>
                    </div>
                    
                    <div class="key-point">
                        <h4>Discussion Prompts (for small groups or families):</h4>
                        <p>Have you ever chosen submission and seen a good result from it?</p>
                        <p>What helps you submit when it's difficult?</p>
                    </div>
                    
                    <div class="key-point">
                        <h4>Additional Learner Activities:</h4>
                        <p><strong>Younger Learners:</strong> Create a "Submission Stoplight" - Draw or glue three circles vertically on paper.</p>
                        <p><strong>Teens/Adults:</strong> Journal or pray about one area of struggle daily for a week.</p>
                        <p><strong>All Ages:</strong> Write a short letter to God confessing a struggle and asking for help to submit.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="topic" id="topic3">
            <div class="topic-completion" id="topic3Complete" data-topic="3"></div>
            <h2>Topic 3: My Heart, Christ's Home</h2>
            
            <div class="scripture">
                <p><strong>Ephesians 3:17</strong> - "that Christ may dwell in your hearts through faith; that you, being rooted and grounded in love,"</p>
            </div>
            
            <div class="key-point">
                <h4>Objective:</h4>
                <p>To help learners understand that following Christ means <strong>giving Him access to every part of our lives</strong>—our thoughts, desires, habits, and hidden areas—not just the public ones.</p>
                <p>Jesus is not a mere visitor—He comes to move in! Your heart is no longer a <strong>guest room</strong>, but now <strong>His home</strong>.</p>
            </div>
            
            <div class="heart-house">
                <div class="heart-house-image">
                    <div class="heart-door">
                        <small>JESUS<br>WELCOME</small>
                    </div>
                </div>
                <p><em>If your heart is a house, are there parts that you allow Jesus to come into and other parts you keep locked?</em></p>
            </div>
            
            <div class="collapsible">1. Living Room</div>
            <div class="content">
                <div class="room-list">
                    <div class="room-metaphor">
                        <h4>The Living Room — Fellowship & Time</h4>
                        <p>This space represents quality time we spend with guests, typifying our devotional lives.</p>
                        <p><strong>Reflection questions:</strong></p>
                        <ul>
                            <li>Are you spending regular, meaningful time with Jesus?</li>
                            <li>What things take your time and focus away from Him?</li>
                        </ul>
                        <p><strong>John 15:5</strong> - "If you remain in me and I in you, you will bear much fruit..."</p>
                    </div>
                </div>
            </div>
            
            <div class="collapsible">2. Kitchen</div>
            <div class="content">
                <div class="room-metaphor">
                    <h4>The Kitchen — Desires, Appetite & Habits</h4>
                    <p>This is where we house our spiritual and physical appetites.</p>
                    <p><strong>Reflection questions:</strong></p>
                    <ul>
                        <li>What are you feeding your soul?</li>
                        <li>Are you more influenced by the world or by Christ about what you desire?</li>
                    </ul>
                    <p><strong>Matthew 4:4</strong> - "Man shall not live on bread alone, but on every word..."</p>
                </div>
            </div>
            
            <div class="collapsible">3. Study Rooms</div>
            <div class="content">
                <div class="room-metaphor">
                    <h4>The Study — Thoughts, Mind, and Learning</h4>
                    <p>What we think shapes how we live.</p>
                    <p><strong>Reflection questions:</strong></p>
                    <ul>
                        <li>What fills your thoughts each day?</li>
                        <li>Is Jesus the Lord of your mind?</li>
                    </ul>
                    <p><strong>Romans 12:2</strong> - "Be transformed by the renewing of your mind."</p>
                </div>
            </div>
            
            <div class="collapsible">4. Bedroom</div>
            <div class="content">
                <div class="room-metaphor">
                    <h4>The Bedroom — Personal/Private Life, Identity, and Purity</h4>
                    <p>This is where the true self resides - rest, identity, purity.</p>
                    <p><strong>Reflection questions:</strong></p>
                    <ul>
                        <li>Do you genuinely honor God in your private choices?</li>
                        <li>Do you invite Jesus into your identity and relationships?</li>
                    </ul>
                    <p><strong>Psalm 139:23-24</strong> - "Search me, God... see if there is any offensive way in me."</p>
                </div>
            </div>
            
            <div class="collapsible">5. Closet</div>
            <div class="content">
                <div class="room-metaphor">
                    <h4>The Closet — Secrets, Sins, and Shame</h4>
                    <p>Places we keep hidden where we don't want anyone (or even God) to see.</p>
                    <p><strong>Reflection questions:</strong></p>
                    <ul>
                        <li>What's hidden in your closet?</li>
                        <li>Is there something you need to confess or surrender?</li>
                    </ul>
                    <p><strong>1 John 1:9</strong> - "If we confess our sins, He is faithful and just to forgive..."</p>
                </div>
            </div>
            
            <div class="collapsible">6. Final Room</div>
            <div class="content">
                <div class="key-point">
                    <h4>Final Room: The Title Deed</h4>
                    <p>Jesus wants more than access—He wants <strong>ownership</strong>.</p>
                    <p><strong>Challenge:</strong> "Will you give Jesus the keys to every room? Will you let Him be not just resident but President—not just guest, but Lord?"</p>
                    <p><strong>Key Scriptures:</strong></p>
                    <ul>
                        <li><strong>Galatians 2:20</strong> - "I no longer live, but Christ lives in me..."</li>
                        <li><strong>Luke 9:23</strong> - "Whoever wants to be my disciple must deny themselves and take up their cross daily..."</li>
                        <li><strong>Romans 12:1</strong> - "Offer your bodies as a living sacrifice, holy and pleasing to God..."</li>
                    </ul>
                </div>
            </div>
            
            <div class="collapsible">Worksheet</div>
            <div class="content">
                <div class="worksheet">
                    <h4>Worksheet: My Heart, Christ's Home</h4>
                    <p><strong>Revelation 3:20 (NIV)</strong> - "Here I am! I stand at the door and knock. If anyone hears my voice and opens the door, I will come in and eat with that person, and they with me."</p>
                    
                    <div class="key-point">
                        <h4>Learner Reflection Questions:</h4>
                        <p>1. Which room in my heart needs to be cleaned or opened to Jesus?</p>
                        <textarea placeholder="Write your response here..." style="width: 100%; min-height: 50px; margin-top: 10px;" data-topic="3" data-question="1"></textarea>
                        
                        <p>2. What would it look like if Jesus fully lived in my heart?</p>
                        <textarea placeholder="Write your response here..." style="width: 100%; min-height: 50px; margin-top: 10px;" data-topic="3" data-question="2"></textarea>
                    </div>
                    
                    <div class="key-point">
                        <h4>Additional Learner Activities:</h4>
                        <p><strong>Children:</strong> Draw a large heart with a door labeled "Jesus, You Are Welcome" and write areas of life to invite Jesus into.</p>
                        <p><strong>Teens:</strong> Write a journal entry titled "A Tour of My Heart" - what Jesus would see in each room.</p>
                        <p><strong>Adults:</strong> Pray through each "room" for a week, asking the Holy Spirit to take complete control.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="lesson-nav">
            <a href="module-lesson2.html" class="btn">Previous Lesson</a>
            <a href="../progress.html" class="btn">Dashboard</a>
             <a href="module-lesson4.html" class="btn">Next Lesson</a>
        </div>
    </div>
    
    <!-- Bottom Navigation -->
    <div class="bottom-nav">
       
        <a href="../progress.html" class="nav-item">
            <i class="bi bi-graph-up nav-icon"></i>
            <span>Dashboard</span>
        </a>
        <a href="resources.html" class="nav-item">
            <i class="bi bi-journal-text nav-icon"></i>
            <span>Resources</span>
        </a>
        <a href="settings.html" class="nav-item">
            <i class="bi bi-gear nav-icon"></i>
            <span>Settings</span>
        </a>
           <a href="#" id="logoutBtn" class="nav-item">
    <span class="nav-icon">🚪</span>
    <span>Logout</span>
</a>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const logoutBtn = document.getElementById('logoutBtn');

    // Logout functionality
    logoutBtn.addEventListener('click', function(event) {
        event.preventDefault();
        if (confirm('Are you sure you want to logout?')) {
            // In a real app, this would clear authentication tokens
            // and redirect to login page
            showNotification('You have been logged out successfully.', 'success');
            
            setTimeout(() => {
                // Simulate logout - in a real app, redirect to login
                window.location.href = '../index.html';
            }, 1500);
        }
    });
});

// Optional: Example notification function
function showNotification(message, type) {
    alert(message); // Replace this with your custom notification UI
}
</script>
    </div>
    
    <!-- Sync Status -->
    <div class="sync-status" id="syncStatus">Checking connection...</div>
    
    <!-- Manual Sync Button -->
    <button id="manualSync" title="Sync Progress">
        <i class="bi bi-arrow-repeat"></i>
    </button>
    
    <!-- Auto-save notification -->
    <div class="save-notification" id="saveNotification">
        <i class="bi bi-check-circle"></i> Progress saved
    </div>
    
    <footer>
        <p>Pathlight Discipleship Curriculum &copy; 2025 | KCMC</p>
        <p>Lit to Lead. Rooted to Grow.</p>
    </footer>

   <script>
// Consolidated progress management for lesson 3
document.addEventListener('DOMContentLoaded', function() {
    console.log('📚 Lesson 3 page loaded, initializing...');
    
    // Logout functionality
    const logoutBtn = document.getElementById('logoutBtn');
    if (logoutBtn) {
        logoutBtn.addEventListener('click', function(event) {
            event.preventDefault();
            if (confirm('Are you sure you want to logout?')) {
                showNotification('You have been logged out successfully.', 'success');
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 1500);
            }
        });
    }

    // Initialize all lesson functionality
    initializeLessonThree();
    
    // Initialize cloud sync for this lesson
    initializeCloudSync();
});

function showNotification(message, type) {
    alert(message);
}

function initializeLessonThree() {
    // Initialize UI elements
    initializeUI();
    
    // Initialize progress tracking
    initializeProgressTracking();
    
    // Load saved progress
    loadSavedProgress();
    
    // Initialize sync functionality
    initializeSync();
}

function initializeCloudSync() {
    console.log('☁️ Initializing cloud sync for lesson 3...');
    
    // Use the universal lesson progress system
    if (window.initializeLessonProgress) {
        window.initializeLessonProgress('lesson3Progress');
    }
    
    // Wait for auth to be ready
    setTimeout(() => {
        if (window.firebaseAuth && window.firebaseAuth.currentUser) {
            console.log('👤 User authenticated, cloud sync ready');
        }
    }, 2000);
}

function initializeUI() {
    // Collapsible sections
    const collapsibles = document.querySelectorAll('.collapsible');
    
    collapsibles.forEach(button => {
        button.addEventListener('click', function() {
            this.classList.toggle('active');
            const content = this.nextElementSibling;
            
            if (content.classList.contains('open')) {
                content.classList.remove('open');
                setTimeout(() => {
                    content.style.maxHeight = null;
                }, 300);
            } else {
                content.classList.add('open');
                content.style.maxHeight = content.scrollHeight + 'px';
            }
        });
    });
    
    // Initialize first section as open
    if (collapsibles.length > 0) {
        collapsibles[0].classList.add('active');
        const firstContent = collapsibles[0].nextElementSibling;
        firstContent.classList.add('open');
        firstContent.style.maxHeight = firstContent.scrollHeight + 'px';
    }
}

function initializeProgressTracking() {
    // Topic completion toggle - ensure compatibility with both systems
    const completionElements = document.querySelectorAll('.topic-completion');
    completionElements.forEach(element => {
        element.addEventListener('click', function() {
            // Toggle both class names for compatibility
            this.classList.toggle('completed');
            this.classList.toggle('topic-completed');
            
            updateAllProgress();
            saveLocalProgress();
        });
    });
    
    // Form field auto-save
    const formFields = document.querySelectorAll('textarea, input[type="text"]');
    formFields.forEach(field => {
        field.addEventListener('input', function() {
            updateAllProgress();
            saveLocalProgress();
            showSaveNotification();
        });
    });
    
    // Auto-save as backup
    setInterval(saveLocalProgress, 30000);
}

function initializeSync() {
    // Manual sync functionality
    const manualSync = document.getElementById('manualSync');
    if (manualSync) {
        manualSync.addEventListener('click', function() {
            triggerManualSync();
        });
    }
    
    // Online/offline detection
    window.addEventListener('online', updateSyncStatus);
    window.addEventListener('offline', updateSyncStatus);
    
    // Initialize sync status
    updateSyncStatus();
}

function updateAllProgress() {
    updateLocalProgress();
    // Universal progress bar will be updated via cloud sync
}

function updateLocalProgress() {
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    const lastSaved = document.getElementById('lastSaved');
    
    if (!progressBar || !progressText) return;
    
    const formFields = document.querySelectorAll('textarea, input[type="text"]');
    const topicCompletions = document.querySelectorAll('.topic-completion');
    
    let completedFields = 0;
    let completedTopics = 0;
    
    // Count completed form fields
    formFields.forEach(field => {
        if (field.value.trim() !== '') {
            completedFields++;
        }
    });
    
    // Count completed topics (check both class names for compatibility)
    topicCompletions.forEach(checkbox => {
        if (checkbox.classList.contains('completed') || checkbox.classList.contains('topic-completed')) {
            completedTopics++;
        }
    });
    
    const totalFields = formFields.length;
    const totalTopics = topicCompletions.length;
    
    // Calculate overall progress (weighted: 70% form fields, 30% topic completion)
    const formProgress = totalFields > 0 ? Math.round((completedFields / totalFields) * 100) : 0;
    const topicProgress = totalTopics > 0 ? Math.round((completedTopics / totalTopics) * 100) : 0;
    const progressPercentage = Math.round((formProgress * 0.7) + (topicProgress * 0.3));
    
    progressBar.style.width = `${progressPercentage}%`;
    progressBar.textContent = `${progressPercentage}%`;
    progressText.textContent = `${progressPercentage}%`;
    
    // Update last saved time
    if (lastSaved) {
        const now = new Date();
        lastSaved.textContent = now.toLocaleTimeString();
    }
}

function saveLocalProgress() {
    // Save all progress data in universal format
    const progressData = getCurrentLessonProgressData();
    localStorage.setItem('lesson3Progress', JSON.stringify(progressData));
    
    // Update sync status
    const syncStatus = document.getElementById('syncStatus');
    if (syncStatus) {
        syncStatus.textContent = 'Saved locally';
        syncStatus.className = 'sync-status saved';
        
        setTimeout(() => {
            updateSyncStatus();
        }, 2000);
    }
}

function loadSavedProgress() {
    const savedProgress = localStorage.getItem('lesson3Progress');
    if (savedProgress) {
        const progressData = JSON.parse(savedProgress);
        applySavedProgress(progressData);
    }
}

function applySavedProgress(progressData) {
    if (!progressData) return;
    
    // Load topic completion (compatible with both systems)
    if (progressData.topics) {
        progressData.topics.forEach(topic => {
            const element = document.querySelectorAll('.topic-completion')[topic.id];
            if (element && topic.completed) {
                element.classList.add('completed', 'topic-completed');
            }
        });
    }
    
    // Load reflection responses
    if (progressData.reflections) {
        Object.keys(progressData.reflections).forEach(reflectionId => {
            const textarea = document.querySelector(`textarea[data-reflection-id="${reflectionId}"]`);
            if (textarea) {
                textarea.value = progressData.reflections[reflectionId];
            }
        });
    }
    
    // Load worksheet data (for backward compatibility)
    if (progressData.worksheet) {
        const formFields = document.querySelectorAll('textarea, input[type="text"]');
        formFields.forEach(field => {
            const topic = field.getAttribute('data-topic');
            const question = field.getAttribute('data-question');
            const reflectionId = field.getAttribute('data-reflection-id');
            
            let value = null;
            
            // Try multiple attribute combinations for compatibility
            if (reflectionId && progressData.reflections && progressData.reflections[reflectionId]) {
                value = progressData.reflections[reflectionId];
            } else if (topic && question && progressData.worksheet[topic] && progressData.worksheet[topic][question]) {
                value = progressData.worksheet[topic][question];
            }
            
            if (value !== null) {
                field.value = value;
            }
        });
    }
    
    updateAllProgress();
}

function updateSyncStatus() {
    const syncStatus = document.getElementById('syncStatus');
    if (!syncStatus) return;
    
    if (navigator.onLine) {
        if (window.firebaseAuth && window.firebaseAuth.currentUser) {
            syncStatus.textContent = 'Online - Synced';
            syncStatus.className = 'sync-status online';
        } else {
            syncStatus.textContent = 'Online - Ready to sync';
            syncStatus.className = 'sync-status online';
        }
    } else {
        syncStatus.textContent = 'Offline - Changes saved locally';
        syncStatus.className = 'sync-status offline';
    }
}

function triggerManualSync() {
    const syncStatus = document.getElementById('syncStatus');
    if (!syncStatus) return;
    
    syncStatus.textContent = 'Syncing...';
    syncStatus.className = 'sync-status syncing';
    
    // Save locally first
    saveLocalProgress();
    
    // Then sync to cloud if available
    if (window.saveProgressToCloud && window.firebaseAuth && window.firebaseAuth.currentUser) {
        const progressData = getCurrentLessonProgressData();
        const saveData = { lesson3Progress: progressData };
        
        window.saveProgressToCloud(saveData)
            .then(() => {
                syncStatus.textContent = 'Synced to cloud';
                syncStatus.className = 'sync-status synced';
                showSyncNotification('Synced to cloud');
            })
            .catch((error) => {
                console.error('Sync failed:', error);
                syncStatus.textContent = 'Sync failed - Saved locally';
                syncStatus.className = 'sync-status error';
            });
    } else {
        // No cloud sync available
        setTimeout(() => {
            syncStatus.textContent = 'Saved locally';
            syncStatus.className = 'sync-status saved';
            showSyncNotification('Saved locally');
        }, 1000);
    }
}

function showSaveNotification() {
    const notification = document.getElementById('saveNotification');
    if (notification) {
        notification.innerHTML = '<i class="bi bi-check-circle"></i> Progress saved';
        notification.classList.add('show');
        
        setTimeout(() => {
            notification.classList.remove('show');
        }, 2000);
    }
}

function showSyncNotification(message) {
    const notification = document.getElementById('saveNotification');
    if (notification) {
        notification.innerHTML = `<i class="bi bi-cloud-check"></i> ${message}`;
        notification.classList.add('show');
        
        setTimeout(() => {
            notification.classList.remove('show');
        }, 3000);
    }
}

// Universal progress data collection (compatible with cloud sync)
function getCurrentLessonProgressData() {
    const progressData = {
        topics: [],
        reflections: {},
        worksheet: {},
        activities: {},
        lastUpdated: new Date().toISOString()
    };
    
    // Get topic completion status (universal format)
    document.querySelectorAll('.topic-completion').forEach((element, index) => {
        const isCompleted = element.classList.contains('completed') || element.classList.contains('topic-completed');
        progressData.topics.push({
            id: index,
            completed: isCompleted
        });
    });
    
    // Get reflection responses (universal format)
    document.querySelectorAll('.reflection textarea').forEach(textarea => {
        const reflectionId = textarea.getAttribute('data-reflection-id');
        if (reflectionId) {
            progressData.reflections[reflectionId] = textarea.value;
        }
    });
    
    // Get worksheet data (backward compatibility)
    const formFields = document.querySelectorAll('textarea, input[type="text"]');
    formFields.forEach(field => {
        const topic = field.getAttribute('data-topic');
        const question = field.getAttribute('data-question');
        
        if (topic && question) {
            if (!progressData.worksheet[topic]) {
                progressData.worksheet[topic] = {};
            }
            progressData.worksheet[topic][question] = field.value;
        }
        
        // Also capture any fields with reflection IDs but no topic/question
        const reflectionId = field.getAttribute('data-reflection-id');
        if (reflectionId && !progressData.reflections[reflectionId]) {
            progressData.reflections[reflectionId] = field.value;
        }
    });
    
    return progressData;
}

// Universal progress loading function for cloud sync
window.manualLoadProgress = function(progressData) {
    console.log('🔄 Loading cloud progress for lesson 3:', progressData);
    applySavedProgress(progressData);
};

// Make functions available globally for cloud sync
window.getCurrentLessonProgressData = getCurrentLessonProgressData;
window.applySavedProgress = applySavedProgress;
</script>

<script type="module" src="../auth-check.js"></script>
</body>
</html>